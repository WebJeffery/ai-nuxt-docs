---
title: 项目开发环境搭建
description: 全面的Nuxt企业级项目开发环境搭建指南，涵盖工具链、CI/CD、监控、测试等完整技术栈
icon: 'lucide:building-2'
---

## 1、项目概述

本指南介绍如何使用 Nuxt 构建大型、可扩展、高性能的企业级应用的开发环境，包括代码质量保证、自动化测试、持续集成、性能监控等企业级特性。

### 1.1 为什么选择 Nuxt4？

**Nuxt4** 是基于 Vue 3 的全栈框架，专为现代Web应用而设计：

- **🚀 性能优异**: 内置 Vite 构建工具，开发体验极佳，构建速度快
- **🔧 开箱即用**: 零配置启动，约定优于配置，减少样板代码
- **🌐 全栈能力**: 前端+后端一体化开发，Nitro 服务器引擎强大
- **📱 现代化**: 支持 SSR、SSG、SPA 等多种渲染模式
- **🔒 类型安全**: 原生 TypeScript 支持，更好的开发体验
- **🎯 SEO友好**: 服务端渲染，搜索引擎优化效果好

### 1.2 企业级开发的核心需求

::card-group{cols=2}
  ::::card{icon="lucide:users"}
  #title
  **团队协作**
  #description
  - 统一的代码规范和风格
  - 自动化的代码检查和格式化
  - 版本控制和分支管理策略
  - 代码审查和质量把控
  ::::

  ::::card{icon="lucide:shield"}
  #title
  **质量保证**
  #description
  - 完整的测试覆盖（单元、集成、E2E）
  - 类型安全和错误预防
  - 性能监控和优化
  - 安全性配置和最佳实践
  ::::

  ::::card{icon="lucide:zap"}
  #title
  **开发效率**
  #description
  - 热重载和快速开发反馈
  - 智能的IDE支持和提示
  - 自动化的构建和部署
  - 开发工具和调试支持
  ::::

  ::::card{icon="lucide:rocket"}
  #title
  **生产就绪**
  #description
  - 容器化部署和扩展
  - CI/CD 流水线自动化
  - 监控、日志和告警
  - 高可用性和容错处理
  ::::
::

::alert{icon="lucide:info" color="blue"}
**适用场景**: 中大型企业、复杂业务系统、多团队协作、高可用性要求的项目
::

## 2、 技术栈概览

### 2.1 技术栈选择原则

在企业级项目中，技术栈的选择至关重要。我们的选择基于以下原则：

1. **🎯 成熟稳定**: 选择经过大规模生产验证的技术
2. **🚀 性能优先**: 优先考虑运行时性能和开发体验
3. **🔧 生态完善**: 拥有丰富的插件和社区支持
4. **👥 团队适配**: 符合团队技术栈和学习曲线
5. **🔮 未来导向**: 技术发展趋势和长期维护性

### 2.2 核心技术栈

**每个技术选择的深度解析：**

::card-group{cols=2}
  ::::card{icon="lucide:layers"}
  #title
  **前端框架**
  #description
  - **Nuxt4**: 基于Vue3的全栈框架，提供SSR/SSG能力
  - **TypeScript 5.x**: 静态类型检查，提升代码质量和开发体验
  - **Tailwind CSS 3.x**: 原子化CSS框架，高效样式开发
  - **Pinia**: Vue3官方推荐的状态管理库，替代Vuex

  **为什么选择Vue3生态？**
  - 组合式API提供更好的逻辑复用和代码组织
  - 更小的包体积和更好的性能
  - 更好的TypeScript支持
  ::::

  ::::card{icon="lucide:server"}
  #title
  **服务端渲染**
  #description
  - **Nitro 服务器引擎**: 高性能服务器运行时，支持多平台部署
  - **全栈 API 开发**: 前后端一体化，减少开发复杂度
  - **边缘函数部署**: 支持Vercel、Netlify等现代部署平台
  - **服务端组件**: 在服务器端渲染组件，减少客户端负载

  **Nitro引擎优势：**
  - 零配置部署到任何平台
  - 自动代码拆分和优化
  - 内置缓存和性能优化
  ::::

  ::::card{icon="lucide:database"}
  #title
  **数据层**
  #description
  - **Prisma ORM**: 现代数据库工具，类型安全的数据库访问
  - **PostgreSQL / MySQL**: 成熟的关系型数据库
  - **Redis 缓存**: 高性能内存数据库，用于缓存和会话存储
  - **GraphQL API**: 灵活的API查询语言，前端按需获取数据

  **数据层架构优势：**
  - Prisma提供类型安全的数据库操作
  - 数据库迁移和版本管理
  - 查询优化和性能监控
  ::::

  ::::card{icon="lucide:shield"}
  #title
  **质量保证**
  #description
  - **ESLint + Prettier**: 代码规范检查和自动格式化
  - **Vitest 单元测试**: 基于Vite的高性能测试框架
  - **Playwright E2E测试**: 跨浏览器端到端测试
  - **SonarQube**: 代码质量和安全性扫描

  **质量保证体系：**
  - 多层次测试覆盖（单元、集成、E2E）
  - 自动化代码质量检查
  - 性能和安全性监控
  ::::
::

## 3、环境准备

### 3.1 系统要求

::alert{icon="lucide:cpu" color="yellow"}
**企业级系统要求**:
- CPU: 4核心以上 (推荐8核心)
- 内存: 16GB以上 (推荐32GB)
- 存储: NVMe SSD 500GB以上
- 网络: 稳定的企业网络环境
::

### 3.2 开发工具安装

#### 1. Node.js 运行时环境

**Node.js 是什么？**
Node.js 是基于 Chrome V8 引擎的 JavaScript 运行时环境，让 JavaScript 可以运行在服务器端。对于 Nuxt4 项目，Node.js 是必需的基础运行时。

**为什么推荐使用 NVM？**
- **版本管理**: 可以安装和切换多个 Node.js 版本
- **项目隔离**: 不同项目可以使用不同的 Node.js 版本
- **团队协作**: 确保团队成员使用相同的 Node.js 版本

```bash
# 使用 Node Version Manager (推荐)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# 重新加载终端配置
source ~/.bashrc

# 安装最新的 LTS 版本
nvm install --lts
nvm use --lts
nvm alias default node

# 验证安装
node --version  # v20.10.0+
npm --version   # v10.2.0+
```

::alert{icon="lucide:lightbulb" color="yellow"}
**版本选择建议**:
- 生产环境建议使用 LTS（长期支持）版本
- Nuxt4 要求 Node.js 18.0.0+ 或更高版本
- 推荐使用 Node.js 20.x 获得更好的性能
::

#### 2. 包管理器配置

**包管理器对比分析：**

| 特性 | npm | yarn | pnpm |
|------|-----|------|------|
| 安装速度 | 中等 | 快 | **最快** |
| 磁盘使用 | 高 | 中等 | **最少** |
| 依赖管理 | 基础 | 良好 | **最严格** |
| 生态兼容 | 完美 | 良好 | 良好 |

**为什么选择 pnpm？**
- **🚀 超快速度**: 比 npm 快 2-3 倍，比 yarn 快 1.5 倍
- **💾 节省空间**: 使用硬链接，避免重复安装相同版本的包
- **🔒 严格依赖**: 防止幻影依赖（phantom dependencies）问题
- **📦 企业友好**: 更好的 monorepo 支持，适合大型项目

```bash
# 安装 pnpm (企业级推荐)
npm install -g pnpm@latest

# 配置企业级设置
pnpm config set store-dir ~/.pnpm-store        # 设置全局存储目录
pnpm config set registry https://registry.npmjs.org/  # 设置镜像源
pnpm config set auto-install-peers true        # 自动安装peer依赖
pnpm config set strict-peer-dependencies false # 允许peer依赖版本不匹配

# 验证配置
pnpm config list
```

**pnpm 工作原理：**
```
传统包管理器 (npm/yarn):
node_modules/
├── package-a/
│   └── node_modules/
│       └── shared-dep/  # 重复安装
├── package-b/
│   └── node_modules/
│       └── shared-dep/  # 重复安装

pnpm 硬链接方式:
.pnpm-store/
└── shared-dep@1.0.0/    # 只存储一份
node_modules/
├── package-a/ -> .pnpm-store/package-a/
├── package-b/ -> .pnpm-store/package-b/
└── .pnpm/
    └── shared-dep@1.0.0/ -> .pnpm-store/shared-dep@1.0.0/
```

#### 3. Git 版本控制

**Git 在企业级开发中的重要性：**
- **版本控制**: 跟踪代码变更历史，支持回滚和分支管理
- **团队协作**: 多人并行开发，解决代码冲突
- **代码审查**: 通过 Pull Request 进行代码质量把控
- **CI/CD集成**: 自动化构建、测试和部署的触发器

```bash
# 全局Git配置
git config --global user.name "Your Name"
git config --global user.email "your.email@company.com"
git config --global init.defaultBranch main          # 设置默认分支为main
git config --global pull.rebase true                 # 拉取时使用rebase而非merge
git config --global core.autocrlf input              # 行尾符自动转换
git config --global core.editor "code --wait"        # 设置默认编辑器为VS Code

# 配置SSH密钥（推荐方式）
ssh-keygen -t ed25519 -C "your.email@company.com"
```

**Git 配置项详解：**

::tabs{variant="line"}
  ::stack{label="分支策略"}
  ```bash
  # 企业级分支管理策略
  git config --global init.defaultBranch main

  # 分支命名规范
  feature/user-auth      # 功能分支
  hotfix/critical-bug    # 热修复分支
  release/v1.2.0         # 发布分支
  ```

  **分支策略说明：**
  - `main`: 主分支，始终保持生产就绪状态
  - `develop`: 开发分支，集成最新功能
  - `feature/*`: 功能分支，独立开发新功能
  - `hotfix/*`: 热修复分支，紧急修复生产问题
  ::

  ::stack{label="提交规范"}
  ```bash
  # 提交信息规范 (Conventional Commits)
  feat: 新功能
  fix: 修复bug
  docs: 文档更新
  style: 代码格式修改
  refactor: 代码重构
  test: 测试相关
  chore: 构建过程或辅助工具变动
  ```

  **提交信息模板：**
  ```
  <type>(<scope>): <subject>

  <body>

  <footer>
  ```
  ::

  ::stack{label="SSH密钥"}
  ```bash
  # 生成SSH密钥
  ssh-keygen -t ed25519 -C "your.email@company.com"

  # 启动ssh-agent
  eval "$(ssh-agent -s)"

  # 添加密钥到ssh-agent
  ssh-add ~/.ssh/id_ed25519

  # 复制公钥到剪贴板
  cat ~/.ssh/id_ed25519.pub | pbcopy  # macOS
  cat ~/.ssh/id_ed25519.pub | xclip -selection clipboard  # Linux
  ```

  **SSH密钥的优势：**
  - 无需每次输入密码
  - 更加安全可靠
  - 支持密钥轮换
  ::
::

## 4、项目搭建步骤

### 4.1 项目初始化

:::steps
#### 1. 项目脚手架

**什么是 `nuxi`？**
`nuxi` 是 Nuxt 的官方 CLI 工具，用于快速创建、开发和构建 Nuxt 应用。

```bash
# 创建新项目
pnpm dlx nuxi@latest init enterprise-nuxt4-app
cd enterprise-nuxt4-app

# 安装依赖
pnpm install
```

**命令解析：**
- `pnpm dlx`: 下载并执行包，类似于 `npx`
- `nuxi@latest`: 使用最新版本的 Nuxt CLI
- `init`: 创建新项目的命令
- `enterprise-nuxt4-app`: 项目名称

**初始化过程中发生了什么？**
1. 📁 创建项目目录结构
2. 📦 生成基础配置文件
3. 🔧 设置 TypeScript 支持
4. 🎨 配置开发服务器
5. 📋 创建示例页面

#### 2. 企业级项目结构

**为什么需要 Monorepo 架构？**
- **代码共享**: 多个应用共享组件和工具
- **统一管理**: 统一的依赖、构建和部署流程
- **团队协作**: 更好的代码复用和维护
- **版本控制**: 统一的版本管理和发布流程

重新组织项目结构以支持企业级开发：

```
enterprise-nuxt4-app/
├── 📁 .github/              # GitHub Actions CI/CD
├── 📁 .vscode/              # VS Code 配置
├── 📁 apps/                 # 应用层
│   ├── 📁 web/              # 主应用
│   └── 📁 admin/            # 管理后台
├── 📁 packages/             # 共享包
│   ├── 📁 ui/               # UI组件库
│   ├── 📁 utils/            # 工具库
│   └── 📁 types/            # 类型定义
├── 📁 docs/                 # 文档
├── 📁 tests/                # 测试
├── 📁 tools/                # 构建工具
├── 📄 pnpm-workspace.yaml   # 工作空间配置
├── 📄 turbo.json           # Turborepo配置
└── 📄 docker-compose.yml   # 本地开发环境
```

单个项目的文件结构设计：

```
src/
├── 📁 assets/               # 静态资源
│   ├── 📁 images/           # 图片资源
│   ├── 📁 icons/            # 图标
│   └── 📁 scss/             # 样式文件
├── 📁 components/           # 组件
│   ├── 📁 base/             # 基础组件
│   ├── 📁 business/         # 业务组件
│   ├── 📁 layout/           # 布局组件
│   └── 📁 form/             # 表单组件
├── 📁 composables/          # 组合式函数
│   ├── 📁 api/              # API相关
│   ├── 📁 auth/             # 认证相关
│   └── 📁 utils/            # 工具函数
├── 📁 layouts/              # 页面布局
├── 📁 middleware/           # 中间件
├── 📁 pages/                # 页面
├── 📁 plugins/              # 插件
├── 📁 server/               # 服务端
│   ├── 📁 api/              # API路由
│   ├── 📁 middleware/       # 服务端中间件
│   └── 📁 utils/            # 服务端工具
├── 📁 stores/               # 状态管理
├── 📁 types/                # 类型定义
└── 📁 utils/                # 工具函数
```

#### 3. 工作空间配置

**工作空间配置的核心概念：**
- **Package管理**: 定义哪些目录包含独立的包
- **依赖关系**: 管理包之间的依赖关系
- **构建流程**: 定义构建任务的执行顺序
- **缓存策略**: 优化构建性能

```yaml
# pnpm-workspace.yaml
packages:
  - 'apps/*' # 应用程序目录
  - 'packages/*' # 共享包目录
  - 'tools/*' # 构建工具目录
```

**工作空间的优势：**
1. **统一依赖**: 所有包共享同一个 `node_modules`
2. **版本一致**: 确保所有包使用相同版本的依赖
3. **开发效率**: 快速的包间链接和热重载
4. **构建优化**: 增量构建和缓存

```json
// turbo.json - Turborepo 构建配置
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"], // 依赖包必须先构建
      "outputs": [".next/**", "!.next/cache/**", "dist/**"] // 构建输出
    },
    "test": {
      "dependsOn": ["^build"], // 测试前需要构建
      "outputs": []
    },
    "lint": {
      "outputs": [] // 代码检查不产生输出文件
    },
    "dev": {
      "cache": false, // 开发模式不缓存
      "persistent": true // 持续运行的任务
    }
  }
}
```

**Turborepo 构建流程：**
```mermaid
graph TD
    A[代码变更] --> B[检测依赖]
    B --> C[计算构建顺序]
    C --> D[并行构建]
    D --> E[缓存结果]
    E --> F[输出到目标]
```
:::

### 4.2 依赖包介绍

#### 4.2.1 基础框架

```bash
# Nuxt4 核心
pnpm add nuxt@latest
pnpm add -D typescript @nuxt/typescript-build

# UI框架
pnpm add @nuxtjs/tailwindcss
pnpm add @headlessui/vue @heroicons/vue
pnpm add @vueuse/nuxt @vueuse/core

# 状态管理
pnpm add pinia @pinia/nuxt
```

#### 4.2.2 企业级增强

```bash
# 国际化
pnpm add @nuxtjs/i18n

# 表单处理
pnpm add @vee-validate/nuxt vee-validate @vee-validate/yup yup

# HTTP客户端
pnpm add @nuxtjs/axios @nuxtjs/proxy

# 身份验证
pnpm add @nuxtjs/auth-next

# 性能监控
pnpm add @nuxtjs/google-analytics
pnpm add @sentry/nuxt
```

#### 4.2.3 开发工具

```bash
# 代码质量
pnpm add -D eslint @nuxt/eslint-config prettier
pnpm add -D @typescript-eslint/parser @typescript-eslint/eslint-plugin
pnpm add -D stylelint stylelint-config-standard-scss

# 测试框架
pnpm add -D vitest @nuxt/test-utils @vue/test-utils
pnpm add -D playwright @playwright/test

# 构建工具
pnpm add -D @nuxt/devtools
pnpm add -D cross-env dotenv-cli
```

### 4.3 配置文件设置

#### 4.3.1 Nuxt4 配置

**Nuxt4 配置文件的核心作用：**
- **应用配置**: 定义应用的基本行为和特性
- **模块管理**: 集成第三方模块和插件
- **构建优化**: 配置构建过程和性能优化
- **开发体验**: 设置开发工具和调试功能

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  // 基础配置
  ssr: true, // 启用服务端渲染，提升SEO和首屏加载速度
  typescript: {
    typeCheck: true, // 构建时进行TypeScript类型检查
    strict: true // 启用严格模式，提高类型安全性
  },

  // 模块配置 - 按功能分组
  modules: [
    '@nuxtjs/tailwindcss', // CSS框架，快速UI开发
    '@pinia/nuxt', // 状态管理，替代Vuex
    '@nuxtjs/i18n', // 国际化支持
    '@vee-validate/nuxt', // 表单验证库
    '@nuxtjs/google-analytics', // 数据分析
    '@sentry/nuxt/module' // 错误监控
  ],

  // CSS预处理器
  css: ['~/assets/scss/main.scss'], // 全局样式入口

  // 构建配置
  build: {
    transpile: ['@headlessui/vue'] // 需要转译的第三方库
  },

  // 运行时配置 - 环境变量管理
  runtimeConfig: {
    // 服务端环境变量（私密信息）
    apiSecret: process.env.API_SECRET,

    // 公共环境变量（客户端可访问）
    public: {
      apiBase: process.env.API_BASE_URL,
      googleAnalyticsId: process.env.GOOGLE_ANALYTICS_ID
    }
  },

  // 性能优化 - Nitro服务器配置
  nitro: {
    preset: 'node-server', // 部署预设
    minify: true, // 压缩输出
    compressPublicAssets: true // 压缩静态资源
  },

  // 开发工具
  devtools: {
    enabled: true, // 启用开发者工具
    timeline: {
      enabled: true // 启用时间线调试
    }
  },

  // 实验性功能
  experimental: {
    payloadExtraction: false, // 禁用payload提取（减少包大小）
    typedPages: true // 启用页面类型推断
  }
});
```

**配置项详解：**

::tabs{variant="line"}
  ::stack{label="渲染模式"}
  ```typescript
  // 渲染模式选择
  export default defineNuxtConfig({
    ssr: true, // 服务端渲染 (SSR)
    // ssr: false, // 单页应用 (SPA)

    // 混合渲染策略
    routeRules: {
      '/': { prerender: true }, // 静态预渲染
      '/admin/**': { ssr: false }, // SPA模式
      '/api/**': { cors: true }, // API路由
      '/blog/**': { isr: 3600 } // 增量静态再生
    }
  });
  ```

  **渲染模式对比：**
  - **SSR**: 服务端渲染，SEO友好，首屏快
  - **SPA**: 单页应用，交互流畅，客户端渲染
  - **SSG**: 静态生成，性能最佳，适合静态内容
  - **ISR**: 增量静态再生，结合静态和动态的优势
  ::

  ::stack{label="模块系统"}
  ```typescript
  // 模块配置最佳实践
  export default defineNuxtConfig({
    modules: [
      // UI和样式
      '@nuxtjs/tailwindcss',
      '@nuxtjs/color-mode',

      // 功能模块
      '@pinia/nuxt',
      '@vueuse/nuxt',
      '@nuxtjs/i18n',

      // 开发工具
      '@nuxt/devtools',

      // 生产工具
      '@nuxtjs/google-analytics',
      '@sentry/nuxt/module'
    ],

    // 模块选项
    tailwindcss: {
      configPath: '~/tailwind.config.js'
    },

    i18n: {
      locales: ['en', 'zh'],
      defaultLocale: 'zh'
    }
  });
  ```

  **模块加载顺序很重要：**
  1. 基础模块（Tailwind CSS）
  2. 功能模块（Pinia、VueUse）
  3. 开发工具
  4. 监控工具
  ::

  ::stack{label="性能优化"}
  ```typescript
  // 性能优化配置
  export default defineNuxtConfig({
    // 构建优化
    build: {
      transpile: ['@headlessui/vue'],
      rollupOptions: {
        output: {
          manualChunks: {
            'vue-vendor': ['vue', 'vue-router'],
            'ui-vendor': ['@headlessui/vue']
          }
        }
      }
    },

    // Nitro优化
    nitro: {
      minify: true,
      compressPublicAssets: true,
      storage: {
        redis: {
          driver: 'redis',
          /* redis config */
        }
      }
    },

    // 实验性优化
    experimental: {
      payloadExtraction: false, // 减少包大小
      inlineSSRStyles: false // 避免内联样式闪烁
    }
  });
  ```
  ::
::

#### 4.3.2 TypeScript 配置

```json
// tsconfig.json
{
  "extends": "./.nuxt/tsconfig.json",
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedIndexedAccess": true,
    "exactOptionalPropertyTypes": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "~/*": ["./src/*"],
      "@@/*": ["./*"],
      "~~/*": ["./*"]
    }
  },
  "include": [
    "**/*.ts",
    "**/*.tsx",
    "**/*.vue"
  ],
  "exclude": [
    "node_modules",
    ".nuxt",
    "dist"
  ]
}
```

#### 4.3.3 ESLint 配置

```javascript
// eslint.config.js
import { createConfigForNuxt } from '@nuxt/eslint-config/flat';

export default createConfigForNuxt({
  features: {
    typescript: true,
    stylistic: true
  }
}).append({
  rules: {
    // 企业级代码规范
    'no-console': 'warn',
    'no-debugger': 'error',
    '@typescript-eslint/no-unused-vars': 'error',
    '@typescript-eslint/no-explicit-any': 'error',
    'vue/multi-word-component-names': 'error',
    'vue/component-name-in-template-casing': ['error', 'PascalCase'],
    'vue/no-v-html': 'error'
  }
});
```

### 4.4. 测试框架配置

####  4.4.1 Vitest 单元测试

```typescript
import { resolve } from 'node:path';
// vitest.config.ts
import { defineConfig } from 'vitest/config';

export default defineConfig({
  test: {
    environment: 'nuxt',
    globals: true,
    setupFiles: ['./tests/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'coverage/**',
        'dist/**',
        'packages/*/test?(s)/**',
        '**/*.d.ts',
        'cypress/**',
        'test?(s)/**',
        'test?(-*).?(c|m)[jt]s?(x)',
        '**/*{.,-}test.?(c|m)[jt]s?(x)',
        '**/*{.,-}spec.?(c|m)[jt]s?(x)',
        '**/__tests__/**',
        '**/{karma,rollup,webpack,vite,vitest,jest,ava,babel,nyc,cypress,tsup,build}.config.*',
        '**/.{eslint,mocha,prettier}rc.{js,cjs,yml}'
      ]
    }
  },
  resolve: {
    alias: {
      '@': resolve(__dirname, './src'),
      '~': resolve(__dirname, './src')
    }
  }
});
```

#### 4.4.2 Playwright E2E测试

```typescript
// playwright.config.ts
import { defineConfig, devices } from '@playwright/test';

export default defineConfig({
  testDir: './tests/e2e',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: 'html',

  use: {
    baseURL: 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure'
  },

  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] }
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] }
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] }
    }
  ],

  webServer: {
    command: 'pnpm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI
  }
});
```

### 4.5 CI/CD 配置

#### 4.5.1 GitHub Actions

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [18.x, 20.x]

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: pnpm

      - name: Install pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Run linting
        run: pnpm run lint

      - name: Run type checking
        run: pnpm run typecheck

      - name: Run unit tests
        run: pnpm run test:unit

      - name: Run E2E tests
        run: pnpm run test:e2e

      - name: Build application
        run: pnpm run build

      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/coverage-final.json

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'

    steps:
      - uses: actions/checkout@v4

      - name: Deploy to production
        run: |
          echo "Deploying to production..."
          # 部署脚本
```

### 4.6 监控与性能

#### 4.6.1 性能监控配置

```typescript
// plugins/monitoring.client.ts
export default defineNuxtPlugin(() => {
  // 性能监控
  if (process.client) {
    // Web Vitals
    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(console.log);
      getFID(console.log);
      getFCP(console.log);
      getLCP(console.log);
      getTTFB(console.log);
    });

    // 错误监控
    window.addEventListener('error', (event) => {
      console.error('Global error:', event.error);
      // 发送到监控系统
    });

    // 未处理的Promise拒绝
    window.addEventListener('unhandledrejection', (event) => {
      console.error('Unhandled promise rejection:', event.reason);
      // 发送到监控系统
    });
  }
});
```

#### 4.6.2 Sentry 错误追踪

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  modules: [
    '@sentry/nuxt/module'
  ],

  sentry: {
    dsn: process.env.SENTRY_DSN,
    environment: process.env.NODE_ENV,
    tracesSampleRate: 1.0,
    integrations: [
      // 性能监控
      // 错误边界
      // 用户反馈
    ]
  }
});
```

### 4.7 Docker 配置

#### 4.7.1 开发环境

```dockerfile
# Dockerfile.dev
FROM node:20-alpine

WORKDIR /app

# 安装pnpm
RUN npm install -g pnpm

# 复制package文件
COPY package*.json pnpm-lock.yaml ./

# 安装依赖
RUN pnpm install

# 复制源代码
COPY . .

# 暴露端口
EXPOSE 3000

# 启动开发服务器
CMD ["pnpm", "run", "dev", "--host", "0.0.0.0"]
```

### 生产环境

```dockerfile
# Dockerfile.prod
FROM node:20-alpine AS builder

WORKDIR /app

# 安装pnpm
RUN npm install -g pnpm

# 复制package文件
COPY package*.json pnpm-lock.yaml ./

# 安装依赖
RUN pnpm install --frozen-lockfile

# 复制源代码
COPY . .

# 构建应用
RUN pnpm run build

# 生产镜像
FROM node:20-alpine AS runner

WORKDIR /app

# 创建非root用户
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nuxtjs

# 复制构建产物
COPY --from=builder --chown=nuxtjs:nodejs /app/.output ./

USER nuxtjs

EXPOSE 3000

ENV NODE_ENV=production

CMD ["node", "server/index.mjs"]
```

### 4.8 安全配置

#### 4.8.1 环境变量管理

```bash
# .env.example
# 数据库配置
DATABASE_URL=postgresql://user:password@localhost:5432/database

# API配置
API_BASE_URL=https://api.example.com
API_SECRET=your-api-secret

# 认证配置
JWT_SECRET=your-jwt-secret
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-nextauth-secret

# 第三方服务
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# 监控配置
SENTRY_DSN=your-sentry-dsn
GOOGLE_ANALYTICS_ID=your-ga-id
```

### 4.9 中间件

```typescript
// middleware/security.global.ts
export default defineNuxtRouteMiddleware((to, from) => {
  // CSP配置
  if (process.server) {
    const event = useRequestEvent();
    setResponseHeader(event, 'Content-Security-Policy', [
      'default-src \'self\'',
      'script-src \'self\' \'unsafe-inline\' \'unsafe-eval\'',
      'style-src \'self\' \'unsafe-inline\'',
      'img-src \'self\' data: https:',
      'font-src \'self\' data:',
      'connect-src \'self\' https://api.example.com'
    ].join('; '));
  }
});
```

## 5、开发流程

### 5.1 代码提交规范

```json
// .commitlintrc.json
{
  "extends": ["@commitlint/config-conventional"],
  "rules": {
    "type-enum": [
      2,
      "always",
      [
        "feat",
        "fix",
        "docs",
        "style",
        "refactor",
        "perf",
        "test",
        "build",
        "ci",
        "chore",
        "revert"
      ]
    ],
    "subject-case": [2, "never", ["sentence-case", "start-case", "pascal-case", "upper-case"]],
    "subject-empty": [2, "never"],
    "subject-full-stop": [2, "never", "."],
    "header-max-length": [2, "always", 72]
  }
}
```

### 5.2 Git Hooks

```bash
# .husky/pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# 运行lint检查
pnpm run lint

# 运行类型检查
pnpm run typecheck

# 运行单元测试
pnpm run test:unit
```

## 6、性能优化

### 6.1 构建优化

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  // 构建优化
  build: {
    transpile: ['@headlessui/vue'],
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router'],
          ui: ['@headlessui/vue', '@heroicons/vue']
        }
      }
    }
  },

  // 资源优化
  image: {
    provider: 'cloudinary',
    cloudinary: {
      baseURL: 'https://res.cloudinary.com/your-cloud-name/image/upload/'
    }
  },

  // 缓存策略
  routeRules: {
    // 静态页面预渲染
    '/': { prerender: true },
    '/about': { prerender: true },

    // API缓存
    '/api/**': { cors: true, headers: { 'cache-control': 's-maxage=60' } },

    // 动态页面ISR
    '/blog/**': { isr: 3600 },

    // SPA模式
    '/admin/**': { ssr: false }
  }
});
```

## 7、部署配置

### 7.1 生产环境部署

```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.prod
    ports:
      - '3000:3000'
    environment:
      - NODE_ENV=production
      - DATABASE_URL=${DATABASE_URL}
    depends_on:
      - db
      - redis
    restart: unless-stopped

  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_DB=${DB_NAME}
      - POSTGRES_USER=${DB_USER}
      - POSTGRES_PASSWORD=${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

  redis:
    image: redis:7-alpine
    restart: unless-stopped

volumes:
  postgres_data:
```

## 8、常见问题和解决方案

### Q1: 项目启动失败

**问题**: 运行 `pnpm dev` 时报错

**解决方案**:
```bash
# 清除缓存
rm -rf .nuxt .output node_modules

# 重新安装依赖
pnpm install

# 重新启动
pnpm dev
```

### Q2: TypeScript 类型错误

**问题**: 类型检查失败

**解决方案**:
```bash
# 生成类型文件
pnpm nuxt prepare

# 重新检查类型
pnpm nuxt typecheck
```

### Q3: 构建失败

**问题**: 生产构建报错

**解决方案**:
```bash
# 检查配置文件语法
pnpm nuxt info

# 清除缓存重新构建
rm -rf .nuxt .output
pnpm build
```

## 🎯 总结

### 企业级特性清单

::card-group{cols=2}
  ::::card{icon="lucide:shield-check"}
  #title
  **安全性**
  #description
  - ✅ 类型安全 (TypeScript)
  - ✅ 输入验证 (Yup)
  - ✅ 安全中间件
  - ✅ 环境变量管理
  ::::

  ::::card{icon="lucide:users"}
  #title
  **团队协作**
  #description
  - ✅ 统一代码规范
  - ✅ 自动化测试
  - ✅ 代码审查流程
  - ✅ 文档生成
  ::::

  ::::card{icon="lucide:zap"}
  #title
  **性能优化**
  #description
  - ✅ 构建优化
  - ✅ 缓存策略
  - ✅ 图片优化
  - ✅ 性能监控
  ::::

  ::::card{icon="lucide:deployment"}
  #title
  **部署运维**
  #description
  - ✅ 容器化部署
  - ✅ CI/CD流水线
  - ✅ 健康检查
  - ✅ 日志监控
  ::::
::

