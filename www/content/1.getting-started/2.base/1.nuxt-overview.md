---
title: Nuxt4 æ¡†æ¶æ¦‚è¿°
description: å…¨é¢äº†è§£ Nuxt4 Alpha ç‰ˆæœ¬çš„æœ€æ–°ç‰¹æ€§ã€å‘å±•å†ç¨‹ã€æ ¸å¿ƒä¼˜åŠ¿ï¼ŒæŒæ¡ç°ä»£åŒ–å…¨æ ˆæ¡†æ¶çš„ç²¾é«“å’Œæœªæ¥æ–¹å‘
icon: 'lucide:code'
---

## 1ã€ä»€ä¹ˆæ˜¯ Nuxt4

### 1.1 Nuxt4 å®šä¹‰ä¸æ ¸å¿ƒæ¦‚å¿µ

**Nuxt4** æ˜¯åŸºäº Vue 3 æ„å»ºçš„ç°ä»£åŒ–å…¨æ ˆ Web æ¡†æ¶ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†æ„å»ºé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„ Web åº”ç”¨ç¨‹åºçš„ SSR å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

::alert{icon="lucide:sparkles" color="blue"}
**æ ¸å¿ƒå®šä½**: Nuxt4 æ˜¯ä¸€ä¸ªå…ƒæ¡†æ¶ (Meta Framework)ï¼Œè‡´åŠ›äºè®© Vue å¼€å‘å˜å¾—æ›´ç®€å•ã€é«˜æ•ˆã€ç°ä»£åŒ–ï¼Œå®ƒåœ¨ Vue 3 çš„åŸºç¡€ä¸Šæä¾›äº†å®Œæ•´çš„åº”ç”¨æ¶æ„ã€å¼€å‘å·¥å…·é“¾å’Œæœ€ä½³å®è·µã€‚
::

### 1.2 Nuxt4 çš„è®¾è®¡ç†å¿µ

::tabs{variant="line"}
  ::stack{label="å¼€å‘ä½“éªŒ"}
  ```bash
  # é›¶é…ç½®å¯åŠ¨
  pnpm create nuxt my-project
  cd my-project && pnpm install
  pnpm dev -o
  ```

  ```typescript
  // è‡ªåŠ¨å¯¼å…¥ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
  export default defineNuxtConfig({
    // å¼€ç®±å³ç”¨çš„é…ç½®
  });
  ```
  ::

  ::stack{label="æ€§èƒ½ä¼˜åŒ–"}
  ```typescript
  // è‡ªåŠ¨ä»£ç åˆ†å‰²
  const LazyComponent = defineAsyncComponent(
    () => import('~/components/HeavyComponent.vue')
  );

  // æ™ºèƒ½é¢„åŠ è½½
  const { data } = await useLazyFetch('/api/data');

  // è‡ªåŠ¨å‹ç¼©ä¼˜åŒ–
  export default defineNuxtConfig({
    nitro: {
      compressPublicAssets: true
    }
  });
  ```
  ::

  ::stack{label="ç±»å‹å®‰å…¨"}
  ```typescript
  // ç«¯åˆ°ç«¯ç±»å‹æ¨æ–­
  const { data } = await useFetch('/api/user'); // è‡ªåŠ¨æ¨æ–­è¿”å›ç±»å‹

  // è·¯ç”±ç±»å‹å®‰å…¨
  await navigateTo('/user/profile'); // è·¯ç”±å‚æ•°ç±»å‹æ£€æŸ¥

  // é…ç½®ç±»å‹æç¤º
  export default defineNuxtConfig({
    runtimeConfig: {
      apiSecret: '', // è‡ªåŠ¨ç±»å‹æ¨æ–­
      public: {
        baseURL: ''
      }
    }
  });
  ```
  ::
::

### 1.3 Nuxt4 çš„æ ¸å¿ƒä»·å€¼

#### 1. ç®€åŒ–å¤æ‚æ€§

**ä¼ ç»Ÿæ–¹å¼**: å¤§é‡çš„é…ç½®ï¼Œæ‰‹åŠ¨å¼•å…¥
```javascript
import { createPinia } from 'pinia';
import { createApp } from 'vue';
// éœ€è¦å¤§é‡é…ç½®
import { createRouter, createWebHistory } from 'vue-router';

const router = createRouter({
  history: createWebHistory(),
  routes: []
});
const pinia = createPinia();
const app = createApp(App);

app.use(router);
app.use(pinia);
app.mount('#app');
```

**Nuxt4 æ–¹å¼**: è‡ªåŠ¨å¯¼å…¥ï¼Œçº¦å®šå¤§äºé…ç½®
```vue
<!-- pages/index.vue -->
<template>
  <div>
    <h1>æ¬¢è¿æ¥åˆ° Nuxt4</h1>
    <NuxtLink to="/about">
      å…³äºæˆ‘ä»¬
    </NuxtLink>
  </div>
</template>

<script setup>
// ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨é…ç½®çš„
const { data } = await useFetch('/api/data');
</script>
```

#### 2. å…¨æ ˆä¸€ä½“åŒ–

```text
é¡¹ç›®ç»“æ„:
â”œâ”€â”€ pages/              # å‰ç«¯é¡µé¢
â”œâ”€â”€ components/         # Vue ç»„ä»¶
â”œâ”€â”€ server/            # æœåŠ¡å™¨ç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/          # API è·¯ç”±
â”‚   â””â”€â”€ middleware/   # æœåŠ¡å™¨ä¸­é—´ä»¶
â”œâ”€â”€ composables/       # ç»„åˆå¼å‡½æ•°
â”œâ”€â”€ plugins/          # æ’ä»¶
â””â”€â”€ nuxt.config.ts    # é…ç½®æ–‡ä»¶
```

#### 3. æ€§èƒ½ä¼˜åŒ–è‡ªåŠ¨åŒ–

```typescript
export default defineNuxtConfig({
  // è‡ªåŠ¨æ€§èƒ½ä¼˜åŒ–
  experimental: {
    payloadExtraction: false,
    inlineSSRStyles: false
  },

  // æ™ºèƒ½æ¸²æŸ“ç­–ç•¥
  routeRules: {
    '/': { prerender: true },
    '/admin/**': { ssr: false },
    '/api/**': { cors: true }
  }
});
```

### 1.4 ç‰ˆæœ¬æ¼”è¿›å†ç¨‹

è®©æˆ‘ä»¬å›é¡¾ Nuxt.js çš„é‡è¦å‘å±•èŠ‚ç‚¹ï¼š

| æ—¶é—´ | ç‰ˆæœ¬ | ä¸»è¦ç‰¹æ€§ |
|------|------|----------|
| 2016å¹´10æœˆ | **Nuxt.js 1.0 å‘å¸ƒ** | - åŸºäº Vue 2.x å’Œ Webpack 2<br>- æä¾›åŸºç¡€çš„ SSR åŠŸèƒ½<br>- å¼•å…¥çº¦å®šå¤§äºé…ç½®çš„ç†å¿µ<br>- æ”¯æŒè‡ªåŠ¨è·¯ç”±ç”Ÿæˆ |
| 2018å¹´1æœˆ | **Nuxt.js 2.0 é‡å¤§æ›´æ–°** | - å‡çº§åˆ° Vue 2.5+ å’Œ Webpack 4<br>- å¼•å…¥ Nuxt.js æ¨¡å—ç³»ç»Ÿ<br>- æ”¯æŒ TypeScript<br>- æ€§èƒ½æ˜¾è‘—æå‡<br>- å¢å¼ºçš„å¼€å‘ä½“éªŒ |
| 2021å¹´8æœˆ | **Nuxt 3 Beta å‘å¸ƒ** | - åŸºäº Vue 3 å’Œ Vite<br>- å…¨æ–°çš„ Nitro æœåŠ¡å™¨å¼•æ“<br>- æ”¯æŒ Composition API<br>- æ›´å¥½çš„ TypeScript æ”¯æŒ |
| 2022å¹´11æœˆ | **Nuxt 3 æ­£å¼å‘å¸ƒ** | - ç”Ÿäº§å°±ç»ªçš„ç¨³å®šç‰ˆæœ¬<br>- å…¨é¢çš„ç”Ÿæ€ç³»ç»Ÿæ”¯æŒ<br>- ä¼ä¸šçº§ç‰¹æ€§å®Œå–„<br>- ç¤¾åŒºæ¨¡å—ä¸°å¯Œ |
| 2024å¹´6æœˆ | **Nuxt 3.12 å‘å¸ƒ** | - ä¸º Nuxt 4 åšå‡†å¤‡<br>- å¼•å…¥ `compatibilityVersion: 4` æµ‹è¯•åŠŸèƒ½<br>- æ€§èƒ½ä¼˜åŒ–å’Œå¼€å‘ä½“éªŒæ”¹è¿›<br>- å†…ç½®æ— éšœç¢åŠŸèƒ½å¢å¼º |
| 2025å¹´4æœˆ | **Nuxt 3.17 å‘å¸ƒ** | - æ•°æ®è·å–å±‚é‡å¤§æ”¹è¿›<br>- æ–°çš„å†…ç½®ç»„ä»¶<br>- æ›´å¥½çš„ç±»å‹å®‰å…¨<br>- æ€§èƒ½æŒç»­ä¼˜åŒ– |
| 2025å¹´6æœˆ | **Nuxt 4 Alpha å‘å¸ƒ** | - ğŸš€ å…¨æ–°çš„ç›®å½•ç»“æ„ (app/ ç›®å½•)<br>- ğŸ”„ æ”¹è¿›çš„æ•°æ®è·å–æœºåˆ¶<br>- ğŸ·ï¸ ä¸€è‡´çš„ç»„ä»¶å‘½å<br>- ğŸ“„ å¢å¼ºçš„å¤´éƒ¨ç®¡ç†<br>- âš¡ å‡†å¤‡é‡‡ç”¨ Vite Environment API |

## 2ã€Nuxt4 å½“å‰çŠ¶æ€

### 2.1 Alpha ç‰ˆæœ¬å‘å¸ƒ

**Nuxt 4 Alpha** äº 2025 å¹´ 6 æœˆ 2 æ—¥æ­£å¼å‘å¸ƒï¼Œç¨³å®šç‰ˆæœ¬é¢„è®¡åœ¨ 2025 å¹´ 6 æœˆåº•å‘å¸ƒã€‚

::alert{icon="lucide:info" color="blue"}
**é‡è¦æé†’**: Nuxt 4 ç›®å‰å¤„äº Alpha é˜¶æ®µï¼ŒAPI å¯èƒ½ä¼šæœ‰å˜åŒ–ã€‚å»ºè®®åœ¨éç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚
::

### 2.2 å¦‚ä½•æµ‹è¯• Nuxt4

æ‚¨å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ä½“éªŒ Nuxt4 çš„æ–°ç‰¹æ€§ï¼š

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨å…¼å®¹æ€§ç‰ˆæœ¬æ ‡å¿—

åœ¨ç°æœ‰çš„ Nuxt 3 é¡¹ç›®ä¸­ï¼Œæ‚¨å¯ä»¥å¯ç”¨ Nuxt 4 çš„å…¼å®¹æ€§æ¨¡å¼ï¼š

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  future: {
    compatibilityVersion: 4
  }
});
```

#### æ–¹å¼äºŒï¼šå®‰è£… Alpha ç‰ˆæœ¬

```bash
# åˆ›å»ºæ–°çš„ Nuxt 4 é¡¹ç›®
pnpm create nuxt@4 my-nuxt4-project

# æˆ–è€…åœ¨ç°æœ‰é¡¹ç›®ä¸­å®‰è£… Alpha ç‰ˆæœ¬
pnpm add nuxt@4
```

### 2.3 ç‰ˆæœ¬æ”¯æŒæ—¶é—´è¡¨

æ ¹æ®å®˜æ–¹è·¯çº¿å›¾ï¼Œç‰ˆæœ¬æ”¯æŒè®¡åˆ’å¦‚ä¸‹ï¼š

| ç‰ˆæœ¬ | æ”¯æŒçŠ¶æ€ | æ”¯æŒæ—¶é—´ |
|------|----------|----------|
| **Nuxt 3** | æŒç»­ç»´æŠ¤ | è‡³ 2025 å¹´åº• |
| **Nuxt 4** | Alpha é˜¶æ®µ | 2025 å¹´ 6 æœˆ - 2026 å¹´ä¸­æœŸ (é¢„è®¡) |
| **Nuxt 5** | è®¡åˆ’ä¸­ | é…åˆ Nitro v3 å‘å¸ƒ |

::alert{icon="lucide:calendar" color="green"}
**ç»´æŠ¤æ‰¿è¯º**: Nuxt å›¢é˜Ÿæ‰¿è¯ºåœ¨ Nuxt 4 å‘å¸ƒåçš„ 6 ä¸ªæœˆå†…ç»§ç»­ç»´æŠ¤ Nuxt 3ï¼Œç¡®ä¿å¹³æ»‘çš„å‡çº§è¿‡æ¸¡ã€‚
::

## 3ã€Nuxt4 çš„æ ¸å¿ƒç»„æˆ

### 3.1 Vue 3 æ ¸å¿ƒå±‚

æä¾›ç°ä»£åŒ–çš„å‰ç«¯å¼€å‘åŸºç¡€ï¼Œæ˜¯ Nuxt4 çš„å“åº”å¼å’Œç»„ä»¶åŒ–åŸºçŸ³ã€‚

::card-group{cols=2}
  ::::card{icon="lucide:layers"}
  #title
  **Composition API**
  #description
  - æ›´å¥½çš„é€»è¾‘å¤ç”¨
  - æ›´æ¸…æ™°çš„ä»£ç ç»„ç»‡
  - æ›´å¼ºçš„ç±»å‹æ¨æ–­
  - æ›´çµæ´»çš„çŠ¶æ€ç®¡ç†
  ::::

  ::::card{icon="lucide:zap"}
  #title
  **å“åº”å¼ç³»ç»Ÿ 3.0**
  #description
  - åŸºäº Proxy çš„å“åº”å¼
  - æ›´å¥½çš„æ€§èƒ½è¡¨ç°
  - æ›´ç²¾ç¡®çš„ä¾èµ–æ”¶é›†
  - æ›´å°‘çš„å†…å­˜å¼€é”€
  ::::
::

```vue
<!-- Vue 3 æ ¸å¿ƒç‰¹æ€§ç¤ºä¾‹ -->
<template>
  <div>
    <h1>{{ title }}</h1>
    <p>è®¿é—®æ¬¡æ•°: {{ count }}</p>
    <button @click="increment">
      å¢åŠ 
    </button>
  </div>
</template>

<script setup>
// Composition API - æ— éœ€å¯¼å…¥
const count = ref(0);
const title = computed(() => `è®¡æ•°å™¨: ${count.value}`);

// å“åº”å¼ç³»ç»Ÿè‡ªåŠ¨å¤„ç†ä¾èµ–
function increment() {
  count.value++;
}

// ç”Ÿå‘½å‘¨æœŸé’©å­
onMounted(() => {
  console.log('ç»„ä»¶å·²æŒ‚è½½');
});
</script>
```

### 3.2 Vite æ„å»ºå¼•æ“

æä¾›æé€Ÿçš„å¼€å‘ä½“éªŒå’Œé«˜æ•ˆçš„ç”Ÿäº§æ„å»ºï¼Œæ˜¯ Nuxt4 æ€§èƒ½ä¼˜åŠ¿çš„é‡è¦æ”¯æ’‘ã€‚

::card-group{cols=2}
  ::::card{icon="lucide:rocket"}
  #title
  **æé€Ÿçƒ­é‡è½½**
  #description
  - æ¯«ç§’çº§çš„æ–‡ä»¶æ›´æ–°
  - ä¿æŒåº”ç”¨çŠ¶æ€
  - ç²¾ç¡®çš„æ¨¡å—æ›´æ–°
  - ä¼˜åŒ–çš„å¼€å‘ä½“éªŒ
  ::::

  ::::card{icon="lucide:package"}
  #title
  **ç°ä»£åŒ–æ„å»º**
  #description
  - ESM åŸç”Ÿæ”¯æŒ
  - æŒ‰éœ€ç¼–è¯‘
  - æ™ºèƒ½ä»£ç åˆ†å‰²
  - ä¼˜åŒ–çš„ç”Ÿäº§æ„å»º
  ::::
::

```typescript
// Vite é…ç½®ç¤ºä¾‹
export default defineNuxtConfig({
  vite: {
    // å¼€å‘æœåŠ¡å™¨é…ç½®
    server: {
      hmr: {
        port: 24678, // çƒ­é‡è½½ç«¯å£
        host: 'localhost'
      }
    },

    // æ„å»ºä¼˜åŒ–
    build: {
      // ä»£ç åˆ†å‰²ç­–ç•¥
      rollupOptions: {
        output: {
          manualChunks: {
            'vue-vendor': ['vue', 'vue-router'],
            'ui-vendor': ['@headlessui/vue', '@heroicons/vue']
          }
        }
      },
      // å‹ç¼©é…ç½®
      minify: 'terser',
      terserOptions: {
        compress: {
          drop_console: true,
          drop_debugger: true
        }
      }
    },

    // æ’ä»¶é…ç½®
    plugins: [
      // è‡ªåŠ¨å¯¼å…¥ä¼˜åŒ–
      AutoImport({
        imports: ['vue', 'vue-router', '@vueuse/core']
      })
    ]
  }
});
```

### 3.3 Nitro æœåŠ¡å™¨å¼•æ“

ç»Ÿä¸€çš„æœåŠ¡å™¨è¿è¡Œæ—¶ï¼Œæ”¯æŒå¤šç§éƒ¨ç½²ç¯å¢ƒå’Œæ¸²æŸ“ç­–ç•¥ï¼Œæ˜¯ Nuxt4 å…¨æ ˆèƒ½åŠ›çš„æ ¸å¿ƒã€‚

::card-group{cols=2}
  ::::card{icon="lucide:server"}
  #title
  **Universal æ¸²æŸ“**
  #description
  - SSR/SSG/SPA ç»Ÿä¸€æ”¯æŒ
  - æ™ºèƒ½æ¸²æŸ“ç­–ç•¥
  - è‡ªåŠ¨ä¼˜åŒ–æ€§èƒ½
  - è¾¹ç¼˜è®¡ç®—æ”¯æŒ
  ::::

  ::::card{icon="lucide:route"}
  #title
  **API è·¯ç”±ç³»ç»Ÿ**
  #description
  - æ–‡ä»¶ç³»ç»Ÿè·¯ç”±
  - ä¸­é—´ä»¶æ”¯æŒ
  - ç±»å‹å®‰å…¨
  - çƒ­é‡è½½æ”¯æŒ
  ::::
::

```typescript
// Nitro é…ç½®ç¤ºä¾‹
export default defineNuxtConfig({
  nitro: {
    // é¢„æ¸²æŸ“é…ç½®
    prerender: {
      routes: ['/sitemap.xml', '/robots.txt', '/'],
      ignore: ['/admin/**', '/api/**']
    },

    // å‹ç¼©é…ç½®
    compressPublicAssets: true,

    // æœåŠ¡å™¨ä¸­é—´ä»¶
    serverHandlers: [
      {
        route: '/api/health',
        handler: '~/server/api/health.get.ts'
      }
    ],

    // éƒ¨ç½²é¢„è®¾
    preset: 'node-server', // æˆ– 'vercel', 'netlify', 'cloudflare'

    // å®éªŒæ€§åŠŸèƒ½
    experimental: {
      wasm: true // WebAssembly æ”¯æŒ
    }
  },

  // è·¯ç”±è§„åˆ™
  routeRules: {
    // é™æ€é¡µé¢
    '/': { prerender: true },
    '/about': { prerender: true },

    // ISR é¡µé¢
    '/blog/**': { isr: 60 },
    '/products/**': { isr: 3600 },

    // SPA é¡µé¢
    '/admin/**': { ssr: false },
    '/dashboard/**': { ssr: false },

    // API è·¯ç”±
    '/api/**': {
      cors: true,
      headers: { 'cache-control': 's-maxage=60' }
    }
  }
});
```

### 3.4 UnJS å·¥å…·é“¾

æä¾›ç°ä»£åŒ–çš„ JavaScript å·¥å…·é›†ï¼Œå®ç°è‡ªåŠ¨åŒ–å’Œç±»å‹å®‰å…¨ï¼Œæ˜¯ Nuxt4 å¼€å‘ä½“éªŒçš„å…³é”®ã€‚

::card-group{cols=2}
  ::::card{icon="lucide:magic-wand"}
  #title
  **è‡ªåŠ¨å¯¼å…¥ç³»ç»Ÿ**
  #description
  - ç»„ä»¶è‡ªåŠ¨å‘ç°
  - Composables è‡ªåŠ¨å¯¼å…¥
  - å·¥å…·å‡½æ•°è‡ªåŠ¨å¯¼å…¥
  - ç¬¬ä¸‰æ–¹åº“è‡ªåŠ¨å¯¼å…¥
  ::::

  ::::card{icon="lucide:shield-check"}
  #title
  **ç±»å‹å®‰å…¨ä¿éšœ**
  #description
  - ç«¯åˆ°ç«¯ç±»å‹æ¨æ–­
  - è‡ªåŠ¨ç±»å‹ç”Ÿæˆ
  - è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥
  - IDE æ™ºèƒ½æç¤º
  ::::
::

```typescript
// UnJS å·¥å…·é“¾é…ç½®ç¤ºä¾‹
export default defineNuxtConfig({
  // è‡ªåŠ¨å¯¼å…¥é…ç½®
  imports: {
    dirs: [
      // è‡ªåŠ¨å¯¼å…¥ç›®å½•
      'composables',
      'composables/*/index.{ts,js,mjs,mts}',
      'composables/**',
      'utils/**'
    ]
  },

  // ç»„ä»¶è‡ªåŠ¨å¯¼å…¥
  components: [
    {
      path: '~/components',
      // å¯ç”¨å‰ç¼€
      prefix: 'App'
    },
    {
      path: '~/components/ui',
      // å…¨å±€ç»„ä»¶
      global: true
    }
  ],

  // ç±»å‹ç”Ÿæˆ
  typescript: {
    typeCheck: true, // æ„å»ºæ—¶ç±»å‹æ£€æŸ¥
    strict: true, // ä¸¥æ ¼æ¨¡å¼
    // è‡ªå®šä¹‰ç±»å‹
    tsConfig: {
      compilerOptions: {
        strict: true,
        noImplicitAny: true
      }
    }
  },

  // è‡ªåŠ¨å¯¼å…¥ç¬¬ä¸‰æ–¹åº“
  auto: {
    imports: [
      // Vue ç”Ÿæ€
      'vue',
      'vue-router',
      '@vueuse/core',
      'pinia',

      // å·¥å…·åº“
      'lodash-es',
      'dayjs',

      // è‡ªå®šä¹‰å¯¼å…¥
      {
        'my-lib': ['myFunction', 'myOtherFunction']
      }
    ]
  }
});
```

### 3.5 æ–‡ä»¶ç³»ç»Ÿè·¯ç”±

åŸºäºæ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼Œç®€åŒ–è·¯ç”±é…ç½®ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

```text
pages/
â”œâ”€â”€ index.vue                    # â†’ /
â”œâ”€â”€ about.vue                   # â†’ /about
â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ index.vue              # â†’ /blog
â”‚   â”œâ”€â”€ [slug].vue             # â†’ /blog/:slug
â”‚   â””â”€â”€ [...slug].vue          # â†’ /blog/:slug*
â””â”€â”€ user/
    â”œâ”€â”€ index.vue              # â†’ /user
    â”œâ”€â”€ [id].vue               # â†’ /user/:id
    â””â”€â”€ settings.vue           # â†’ /user/settings
```

**é«˜çº§è·¯ç”±ç‰¹æ€§**:

::tabs{variant="line"}
  ::stack{label="åŠ¨æ€è·¯ç”±"}
  ```vue
  <!-- pages/user/[id].vue -->
  <template>
    <div>
      <h1>ç”¨æˆ·è¯¦æƒ…</h1>
      <p>ç”¨æˆ·ID: {{ $route.params.id }}</p>
    </div>
  </template>

  <script setup>
  // è‡ªåŠ¨è·å–è·¯ç”±å‚æ•°
  const route = useRoute();
  const userId = route.params.id;

  // æ•°æ®è·å–
  const { data: user } = await useFetch(`/api/users/${userId}`);
  </script>
  ```
  ::

  ::stack{label="åµŒå¥—è·¯ç”±"}
  ```text
  pages/
  â”œâ”€â”€ user/
  â”‚   â”œâ”€â”€ index.vue          # /user
  â”‚   â”œâ”€â”€ [id].vue           # /user/:id
  â”‚   â””â”€â”€ [id]/
  â”‚       â”œâ”€â”€ profile.vue    # /user/:id/profile
  â”‚       â””â”€â”€ settings.vue   # /user/:id/settings
  â””â”€â”€ user.vue               # çˆ¶çº§å¸ƒå±€
  ```
  ::

  ::stack{label="è·¯ç”±ä¸­é—´ä»¶"}
  ```typescript
  // middleware/auth.ts
  export default defineNuxtRouteMiddleware((to, from) => {
    const user = useAuthUser();

    if (!user.value) {
      return navigateTo('/login');
    }
  });
  ```
  ::
::

### 3.6 æœåŠ¡å™¨ç«¯åŠŸèƒ½

æä¾›å®Œæ•´çš„åç«¯å¼€å‘èƒ½åŠ›ï¼Œå®ç°çœŸæ­£çš„å…¨æ ˆå¼€å‘ä½“éªŒã€‚

::code-group
```typescript [API è·¯ç”±]
// server/api/users.get.ts - RESTful API
export default defineEventHandler(async (event) => {
  const query = getQuery(event);
  const users = await getUsersFromDB(query);

  return {
    users,
    total: users.length,
    pagination: {
      page: query.page || 1,
      limit: query.limit || 10
    }
  };
});

// server/api/users.post.ts - åˆ›å»ºç”¨æˆ·
export default defineEventHandler(async (event) => {
  const body = await readBody(event);

  // éªŒè¯æ•°æ®
  const validation = await validateUser(body);
  if (!validation.success) {
    throw createError({
      statusCode: 400,
      statusMessage: validation.error
    });
  }

  // åˆ›å»ºç”¨æˆ·
  const user = await createUser(body);
  return { user };
});
```

```typescript [æœåŠ¡å™¨ä¸­é—´ä»¶]
// server/middleware/auth.ts - è®¤è¯ä¸­é—´ä»¶
export default defineEventHandler(async (event) => {
  // è·³è¿‡å…¬å…± API
  if (event.node.req.url?.startsWith('/api/public/')) {
    return;
  }

  // éªŒè¯ç”¨æˆ·èº«ä»½
  const token = getCookie(event, 'auth-token');
  if (!token) {
    throw createError({
      statusCode: 401,
      statusMessage: 'Unauthorized'
    });
  }

  // éªŒè¯ token
  try {
    const user = await verifyToken(token);
    event.context.user = user;
  } catch (error) {
    throw createError({
      statusCode: 401,
      statusMessage: 'Invalid token'
    });
  }
});
```

```typescript [æ•°æ®åº“é›†æˆ]
// server/api/database.ts - æ•°æ®åº“æ“ä½œ
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

export default defineEventHandler(async (event) => {
  const method = getMethod(event);

  switch (method) {
    case 'GET':
      return await prisma.user.findMany();

    case 'POST': {
      const body = await readBody(event);
      return await prisma.user.create({
        data: body
      });
    }

    default:
      throw createError({
        statusCode: 405,
        statusMessage: 'Method not allowed'
      });
  }
});
```
::

### 3.7 æ ¸å¿ƒç»„æˆæ€»ç»“

| ç»„æˆéƒ¨åˆ† | ä¸»è¦ä½œç”¨ | æ ¸å¿ƒç‰¹æ€§ | å¼€å‘ä»·å€¼ |
|----------|----------|----------|----------|
| **Vue 3 æ ¸å¿ƒå±‚** | å‰ç«¯å“åº”å¼åŸºç¡€ | â€¢ Composition API<br>â€¢ å“åº”å¼ç³»ç»Ÿ 3.0<br>â€¢ ç»„ä»¶ç³»ç»Ÿå‡çº§ | ç°ä»£åŒ–å¼€å‘ä½“éªŒ |
| **Vite æ„å»ºå¼•æ“** | æé€Ÿæ„å»ºå·¥å…· | â€¢ æ¯«ç§’çº§çƒ­é‡è½½<br>â€¢ ESM åŸç”Ÿæ”¯æŒ<br>â€¢ æ™ºèƒ½ä»£ç åˆ†å‰² | å¼€å‘æ•ˆç‡æå‡ |
| **Nitro æœåŠ¡å™¨å¼•æ“** | ç»Ÿä¸€æœåŠ¡å™¨è¿è¡Œæ—¶ | â€¢ å¤šç§æ¸²æŸ“æ¨¡å¼<br>â€¢ API è·¯ç”±ç³»ç»Ÿ<br>â€¢ è¾¹ç¼˜è®¡ç®—æ”¯æŒ | å…¨æ ˆå¼€å‘èƒ½åŠ› |
| **UnJS å·¥å…·é“¾** | è‡ªåŠ¨åŒ–å·¥å…·é›† | â€¢ è‡ªåŠ¨å¯¼å…¥ç³»ç»Ÿ<br>â€¢ ç±»å‹å®‰å…¨ä¿éšœ<br>â€¢ çº¦å®šä¼˜äºé…ç½® | å¼€å‘ä½“éªŒä¼˜åŒ– |
| **æ–‡ä»¶ç³»ç»Ÿè·¯ç”±** | è‡ªåŠ¨è·¯ç”±ç”Ÿæˆ | â€¢ åŠ¨æ€è·¯ç”±<br>â€¢ åµŒå¥—è·¯ç”±<br>â€¢ è·¯ç”±ä¸­é—´ä»¶ | è·¯ç”±é…ç½®ç®€åŒ– |
| **æœåŠ¡å™¨ç«¯åŠŸèƒ½** | åç«¯å¼€å‘æ”¯æŒ | â€¢ API è·¯ç”±<br>â€¢ æœåŠ¡å™¨ä¸­é—´ä»¶<br>â€¢ æ•°æ®åº“é›†æˆ | å…¨æ ˆä¸€ä½“åŒ– |

## 4ã€ Nuxt4 çš„ç‰¹æ€§ä¸ä¼˜åŠ¿

### 4.1 æ ¸å¿ƒç‰¹æ€§

#### 1. å¤šç§æ¸²æŸ“æ¨¡å¼

::tabs{variant="line"}
  ::stack{label="æœåŠ¡ç«¯æ¸²æŸ“ (SSR)"}
  ```typescript
  // nuxt.config.ts
  export default defineNuxtConfig({
    ssr: true, // é»˜è®¤å¯ç”¨ SSR

    routeRules: {
      // ç‰¹å®šé¡µé¢çš„æ¸²æŸ“ç­–ç•¥
      '/admin/**': { ssr: false }, // SPA æ¨¡å¼
      '/blog/**': { isr: 60 }, // ISR æ¨¡å¼
    }
  });
  ```

  **ä¼˜åŠ¿**:
  - ğŸš€ æ›´å¿«çš„é¦–å±åŠ è½½
  - ğŸ” æ›´å¥½çš„ SEO æ•ˆæœ
  - ğŸ¯ æ›´ä½³çš„ç”¨æˆ·ä½“éªŒ
  - ğŸ“± ç§»åŠ¨ç«¯å‹å¥½
  ::

  ::stack{label="é™æ€ç”Ÿæˆ (SSG)"}
  ```typescript
  // nuxt.config.ts
  export default defineNuxtConfig({
    nitro: {
      prerender: {
        routes: ['/sitemap.xml', '/robots.txt']
      }
    }
  });
  ```

  **ä¼˜åŠ¿**:
  - âš¡ æé€ŸåŠ è½½é€Ÿåº¦
  - ğŸ’° æ›´ä½çš„æœåŠ¡å™¨æˆæœ¬
  - ğŸ”’ æ›´é«˜çš„å®‰å…¨æ€§
  - ğŸŒ CDN å‹å¥½
  ::

  ::stack{label="å®¢æˆ·ç«¯æ¸²æŸ“ (SPA)"}
  ```typescript
  // nuxt.config.ts
  export default defineNuxtConfig({
    ssr: false, // å…¨å±€ SPA æ¨¡å¼

    // æˆ–è€…æŒ‰è·¯ç”±é…ç½®
    routeRules: {
      '/app/**': { ssr: false }
    }
  });
  ```

  **ä¼˜åŠ¿**:
  - ğŸ® æ›´æµç•…çš„äº¤äº’ä½“éªŒ
  - ğŸ“Š é€‚åˆå¤æ‚çš„åº”ç”¨é€»è¾‘
  - ğŸ”„ å‡å°‘æœåŠ¡å™¨è´Ÿè½½
  - ğŸ’¾ æ›´å¥½çš„ç¼“å­˜ç­–ç•¥
  ::

  ::stack{label="å¢é‡é™æ€å†ç”Ÿ (ISR)"}
  ```typescript
  // nuxt.config.ts
  export default defineNuxtConfig({
    routeRules: {
      '/blog/**': { isr: 60 }, // 60ç§’ç¼“å­˜
      '/products/**': { isr: 3600 }, // 1å°æ—¶ç¼“å­˜
    }
  });
  ```

  **ä¼˜åŠ¿**:
  - ğŸ”„ è‡ªåŠ¨å†…å®¹æ›´æ–°
  - âš¡ é™æ€æ–‡ä»¶é€Ÿåº¦
  - ğŸ¯ æŒ‰éœ€é‡æ–°ç”Ÿæˆ
  - ğŸ“ˆ å¯æ‰©å±•æ€§å¼º
  ::
::

#### 2. è‡ªåŠ¨å¯¼å…¥ç³»ç»Ÿ

```vue
<!-- æ— éœ€æ‰‹åŠ¨å¯¼å…¥ -->
<template>
  <div>
    <!-- ç»„ä»¶è‡ªåŠ¨å¯¼å…¥ -->
    <UiButton @click="handleLogin">
      ç™»å½•
    </UiButton>
    <BaseModal v-model="showModal">
      <LoginForm @success="onLoginSuccess" />
    </BaseModal>
  </div>
</template>

<script setup>
// Composables è‡ªåŠ¨å¯¼å…¥
const user = useAuthUser();
const { login } = useAuth();
const router = useRouter();
const { $toast } = useNuxtApp();

// å·¥å…·å‡½æ•°è‡ªåŠ¨å¯¼å…¥
const formatDate = date => useDateFormat(date, 'YYYY-MM-DD');
const debounced = useDebounce(searchQuery, 300);

// ç¬¬ä¸‰æ–¹åº“è‡ªåŠ¨å¯¼å…¥
const { copy } = useClipboard();
const { pause, resume } = useIntervalFn(() => {
  // å®šæ—¶ä»»åŠ¡
}, 1000);

const showModal = ref(false);

async function handleLogin() {
  try {
    await login(credentials);
    $toast.success('ç™»å½•æˆåŠŸ');
    router.push('/dashboard');
  } catch (error) {
    $toast.error('ç™»å½•å¤±è´¥');
  }
}
</script>
```

#### 3. æ•°æ®è·å–ç­–ç•¥

::code-group
```vue [æœåŠ¡ç«¯æ•°æ®è·å–]
<!-- pages/posts/[id].vue -->
<template>
  <article>
    <h1>{{ post.title }}</h1>
    <div v-html="post.content" />
    <CommentSection :comments="comments" />
  </article>
</template>

<script setup>
const route = useRoute();
const postId = route.params.id;

// å¹¶è¡Œæ•°æ®è·å–
const [
  { data: post },
  { data: comments }
] = await Promise.all([
  useFetch(`/api/posts/${postId}`),
  useFetch(`/api/posts/${postId}/comments`)
]);

// åŠ¨æ€ SEO
useSeoMeta({
  title: post.value.title,
  description: post.value.excerpt
});
</script>
```

```vue [å®¢æˆ·ç«¯æ•°æ®è·å–]
<!-- components/UserProfile.vue -->
<template>
  <div>
    <div v-if="pending">
      <LoadingSkeleton />
    </div>
    <div v-else-if="error">
      <ErrorMessage :error="error" />
    </div>
    <div v-else>
      <h2>{{ user.name }}</h2>
      <p>{{ user.bio }}</p>
    </div>
  </div>
</template>

<script setup>
const props = defineProps<{
  userId: string;
}>();

// å®¢æˆ·ç«¯æ•°æ®è·å–
const { data: user, pending, error, refresh } = await useLazyFetch(
  `/api/users/${props.userId}`,
  {
    server: false, // ä»…åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ
    key: `user-${props.userId}` // ç¼“å­˜é”®
  }
);
</script>
```

```vue [æ··åˆæ•°æ®è·å–]
<!-- pages/dashboard.vue -->
<template>
  <div>
    <!-- æœåŠ¡ç«¯æ•°æ® - é¦–å±å…³é”®ä¿¡æ¯ -->
    <DashboardHeader :user="user" :stats="stats" />

    <!-- å®¢æˆ·ç«¯æ•°æ® - éå…³é”®ä¿¡æ¯ -->
    <LazyDashboardCharts />
    <LazyRecentActivities />
  </div>
</template>

<script setup>
// å®šä¹‰é¡µé¢å…ƒæ•°æ®
definePageMeta({
  middleware: 'auth'
});

// æœåŠ¡ç«¯è·å–å…³é”®æ•°æ®
const { data: user } = await useFetch('/api/user');
const { data: stats } = await useFetch('/api/dashboard/stats');

// å®¢æˆ·ç«¯è·å–éå…³é”®æ•°æ®
const { data: activities } = await useLazyFetch('/api/activities', {
  server: false
});
</script>
```
::

#### 4. æ™ºèƒ½ç¼“å­˜ç­–ç•¥

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  routeRules: {
    // é™æ€é¡µé¢ç¼“å­˜
    '/': {
      prerender: true,
      headers: { 'cache-control': 's-maxage=31536000' }
    },

    // åŠ¨æ€é¡µé¢ç¼“å­˜
    '/blog/**': {
      isr: 60,
      headers: { 'cache-control': 's-maxage=60' }
    },

    // API ç¼“å­˜
    '/api/public/**': {
      cors: true,
      headers: { 'cache-control': 's-maxage=300' }
    },

    // ç¦ç”¨ç¼“å­˜
    '/api/private/**': {
      headers: { 'cache-control': 'no-cache' }
    }
  }
});
```

### 4.2 æ ¸å¿ƒä¼˜åŠ¿

#### 1. å¼€å‘ä½“éªŒä¼˜åŠ¿

::card-group{cols=2}
  ::::card{icon="lucide:zap"}
  #title
  **æé€Ÿå¼€å‘**
  #description
  - åŸºäº Vite çš„æ¯«ç§’çº§çƒ­é‡è½½
  - é›¶é…ç½® TypeScript æ”¯æŒ
  - è‡ªåŠ¨å¯¼å…¥å‡å°‘æ ·æ¿ä»£ç 
  - å†…ç½®å¼€å‘è€…å·¥å…·
  ::::

  ::::card{icon="lucide:brain"}
  #title
  **æ™ºèƒ½æç¤º**
  #description
  - ç«¯åˆ°ç«¯ç±»å‹æ¨æ–­
  - è·¯ç”±ç±»å‹å®‰å…¨
  - è‡ªåŠ¨è¡¥å…¨å’Œé”™è¯¯æ£€æŸ¥
  - æ™ºèƒ½é‡æ„æ”¯æŒ
  ::::

  ::::card{icon="lucide:layers"}
  #title
  **æ¨¡å—åŒ–æ¶æ„**
  #description
  - å¯æ’æ‹”çš„æ¨¡å—ç³»ç»Ÿ
  - çµæ´»çš„æ’ä»¶æœºåˆ¶
  - ç»„ä»¶è‡ªåŠ¨å‘ç°
  - çº¦å®šä¼˜äºé…ç½®
  ::::

  ::::card{icon="lucide:wrench"}
  #title
  **è°ƒè¯•å‹å¥½**
  #description
  - è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
  - æºç æ˜ å°„æ”¯æŒ
  - æ€§èƒ½åˆ†æå·¥å…·
  - çƒ­é‡è½½è°ƒè¯•
  ::::
::

#### 2. æ€§èƒ½ä¼˜åŠ¿

| æ€§èƒ½æŒ‡æ ‡ | ä¼ ç»Ÿ Vue SPA | Nuxt4 SSR | æå‡å¹…åº¦ |
|----------|-------------|-----------|----------|
| **é¦–å±åŠ è½½æ—¶é—´** | 2-5ç§’ | 0.5-1ç§’ | ğŸš€ **70-80%** |
| **SEO å‹å¥½åº¦** | ä½ | é«˜ | ğŸ“ˆ **æ˜¾è‘—æå‡** |
| **æ„å»ºé€Ÿåº¦** | åŸºå‡† | 3-5x æ›´å¿« | âš¡ **300-500%** |
| **å¼€å‘çƒ­é‡è½½** | 1-3ç§’ | 200ms | ğŸ”¥ **85-90%** |
| **åŒ…ä½“ç§¯** | åŸºå‡† | å‡å°‘ 20-30% | ğŸ“¦ **25%** |

#### 3. æ¶æ„ä¼˜åŠ¿

::tabs{variant="line"}
  ::stack{label="æ–‡ä»¶ç»“æ„"}
  ```text
  Nuxt4-project/
  â”œâ”€â”€ assets/           # é™æ€èµ„æº
  â”œâ”€â”€ components/       # Vue ç»„ä»¶
  â”œâ”€â”€ composables/      # ç»„åˆå¼å‡½æ•°
  â”œâ”€â”€ layouts/          # å¸ƒå±€ç»„ä»¶
  â”œâ”€â”€ middleware/       # è·¯ç”±ä¸­é—´ä»¶
  â”œâ”€â”€ pages/            # è·¯ç”±é¡µé¢
  â”œâ”€â”€ plugins/          # æ’ä»¶
  â”œâ”€â”€ public/           # å…¬å…±æ–‡ä»¶
  â”œâ”€â”€ server/           # æœåŠ¡å™¨ç«¯ä»£ç 
  â”‚   â”œâ”€â”€ api/         # API è·¯ç”±
  â”‚   â””â”€â”€ middleware/  # æœåŠ¡å™¨ä¸­é—´ä»¶
  â”œâ”€â”€ stores/          # çŠ¶æ€ç®¡ç†
  â””â”€â”€ nuxt.config.ts   # é…ç½®æ–‡ä»¶
  ```
  ::

  ::stack{label="æ¸²æŸ“ç­–ç•¥"}
  ```typescript
  // çµæ´»çš„æ¸²æŸ“é…ç½®
  export default defineNuxtConfig({
    routeRules: {
      // é¦–é¡µé¢„æ¸²æŸ“
      '/': { prerender: true },

      // åšå®¢å¢é‡é™æ€å†ç”Ÿ
      '/blog/**': { isr: 60 },

      // ç®¡ç†åå°SPAæ¨¡å¼
      '/admin/**': { ssr: false },

      // APIè·¯ç”±
      '/api/**': { cors: true }
    }
  });
  ```
  ::

  ::stack{label="æ¨¡å—ç”Ÿæ€"}
  ```typescript
  // ä¸°å¯Œçš„æ¨¡å—ç”Ÿæ€
  export default defineNuxtConfig({
    modules: [
      '@nuxt/ui', // UI ç»„ä»¶åº“
      '@nuxt/image', // å›¾ç‰‡ä¼˜åŒ–
      '@nuxt/content', // å†…å®¹ç®¡ç†
      '@pinia/nuxt', // çŠ¶æ€ç®¡ç†
      '@nuxtjs/i18n', // å›½é™…åŒ–
      '@nuxtjs/seo' // SEO ä¼˜åŒ–
    ]
  });
  ```
  ::
::

## 5ã€ ä¸ Vue3 çš„å…³ç³»

### 5.1 æ·±åº¦é›†æˆå…³ç³»

Nuxt4 ä¸ Vue 3 çš„å…³ç³»å¯ä»¥ç”¨"è¡€è„‰ç›¸è¿"æ¥å½¢å®¹ã€‚Nuxt4 ä¸æ˜¯ç®€å•åœ°ä½¿ç”¨ Vue 3ï¼Œè€Œæ˜¯æ·±åº¦é›†æˆå’Œæ‰©å±•äº† Vue 3 çš„èƒ½åŠ›ã€‚

::alert{icon="lucide:info" color="blue"}
**æ ¸å¿ƒå…³ç³»**: Nuxt4 = Vue 3 + å…¨æ ˆå¼€å‘èƒ½åŠ› + æœ€ä½³å®è·µ + å¼€å‘è€…ä½“éªŒä¼˜åŒ–
::

### 5.2 Vue 3 ç‰¹æ€§ç»§æ‰¿

#### 1. Composition API å®Œå…¨æ”¯æŒ

::code-group
```vue [Vue 3 åŸç”Ÿç”¨æ³•]
<!-- æ ‡å‡† Vue 3 ç»„ä»¶ -->
<template>
  <div>
    <h1>{{ title }}</h1>
    <button @click="increment">
      {{ count }}
    </button>
  </div>
</template>

<script setup>
import { computed, onMounted, ref } from 'vue';

const count = ref(0);
const title = computed(() => `è®¡æ•°: ${count.value}`);

function increment() {
  count.value++;
}

onMounted(() => {
  console.log('ç»„ä»¶å·²æŒ‚è½½');
});
</script>
```

```vue [Nuxt4 å¢å¼ºç”¨æ³•]
<!-- Nuxt4 ç»„ä»¶ - æ— éœ€å¯¼å…¥ -->
<template>
  <div>
    <h1>{{ title }}</h1>
    <button @click="increment">
      {{ count }}
    </button>
    <UserProfile :user="user" />
  </div>
</template>

<script setup>
// æ— éœ€å¯¼å…¥ Vue 3 APIï¼Œè‡ªåŠ¨å¯ç”¨
const count = ref(0);
const title = computed(() => `è®¡æ•°: ${count.value}`);

// Nuxt4 ç‰¹æœ‰çš„æ•°æ®è·å–
const { data: user } = await useFetch('/api/user');

// è‡ªåŠ¨å¯¼å…¥çš„ç»„åˆå¼å‡½æ•°
const { locale } = useI18n();
const router = useRouter();

function increment() {
  count.value++;
}

onMounted(() => {
  console.log('ç»„ä»¶å·²æŒ‚è½½');
});
</script>
```
::

#### 2. å“åº”å¼ç³»ç»Ÿ 3.0

```vue
<template>
  <div>
    <!-- å“åº”å¼æ•°æ®ç»‘å®š -->
    <input v-model="searchQuery" placeholder="æœç´¢...">

    <!-- è®¡ç®—å±æ€§ -->
    <p>æœç´¢ç»“æœ: {{ filteredResults.length }} æ¡</p>

    <!-- å“åº”å¼åˆ—è¡¨æ¸²æŸ“ -->
    <ul>
      <li v-for="item in filteredResults" :key="item.id">
        {{ item.name }}
      </li>
    </ul>
  </div>
</template>

<script setup>
// å“åº”å¼æ•°æ®
const searchQuery = ref('');
const items = ref([]);

// è®¡ç®—å±æ€§ - è‡ªåŠ¨ä¾èµ–æ”¶é›†
const filteredResults = computed(() => {
  if (!searchQuery.value)
    return items.value;

  return items.value.filter(item =>
    item.name.toLowerCase().includes(searchQuery.value.toLowerCase())
  );
});

// ä¾¦å¬å™¨ - å“åº”å¼æ›´æ–°
watch(searchQuery, (newQuery) => {
  console.log('æœç´¢è¯æ›´æ–°:', newQuery);
});

// æ•°æ®è·å–
const { data } = await useFetch('/api/items');
items.value = data.value;
</script>
```

#### 3. ç»„ä»¶ç³»ç»Ÿå‡çº§

::tabs{variant="line"}
  ::stack{label="ç»„ä»¶å®šä¹‰"}
  ```vue
  <!-- components/UserCard.vue -->
  <template>
    <div class="user-card">
      <img :src="user.avatar" :alt="user.name">
      <h3>{{ user.name }}</h3>
      <p>{{ user.bio }}</p>

      <!-- æ’æ§½æ”¯æŒ -->
      <slot name="actions" :user="user" />
    </div>
  </template>

  <script setup>
  // ç±»å‹å®‰å…¨çš„ Props
  interface User {
    id: number;
    name: string;
    avatar: string;
    bio: string;
  }

  const props = defineProps<{
    user: User;
  }>();

  // äº‹ä»¶å®šä¹‰
  const emit = defineEmits<{
    follow: [userId: number];
    unfollow: [userId: number];
  }>();
  </script>
  ```
  ::

  ::stack{label="ç»„ä»¶ä½¿ç”¨"}
  ```vue
  <!-- pages/users.vue -->
  <template>
    <div>
      <!-- è‡ªåŠ¨å¯¼å…¥çš„ç»„ä»¶ -->
      <UserCard
        v-for="user in users"
        :key="user.id"
        :user="user"
        @follow="handleFollow"
      >
        <template #actions="{ user }">
          <button @click="followUser(user.id)">
            å…³æ³¨
          </button>
        </template>
      </UserCard>
    </div>
  </template>

  <script setup>
  const { data: users } = await useFetch('/api/users');

  function handleFollow(userId: number) {
    // å…³æ³¨é€»è¾‘
    console.log('å…³æ³¨ç”¨æˆ·:', userId);
  }
  </script>
  ```
  ::
::

### 5.3 Nuxt4 çš„æ‰©å±•å¢å¼º

#### 1. æœåŠ¡ç«¯æ¸²æŸ“èƒ½åŠ›

```vue
<!-- pages/product/[id].vue -->
<template>
  <div>
    <h1>{{ product.name }}</h1>
    <p>{{ product.description }}</p>
    <img :src="product.image" :alt="product.name">

    <!-- å®¢æˆ·ç«¯äº¤äº’ -->
    <button :disabled="loading" @click="addToCart">
      {{ loading ? 'æ·»åŠ ä¸­...' : 'åŠ å…¥è´­ç‰©è½¦' }}
    </button>
  </div>
</template>

<script setup>
const route = useRoute();
const productId = route.params.id;

// æœåŠ¡ç«¯æ•°æ®è·å– - SEOå‹å¥½
const { data: product } = await useFetch(`/api/products/${productId}`);

// å®¢æˆ·ç«¯çŠ¶æ€
const loading = ref(false);

// å®¢æˆ·ç«¯äº¤äº’
async function addToCart() {
  loading.value = true;
  try {
    await $fetch('/api/cart/add', {
      method: 'POST',
      body: { productId: product.value.id }
    });

    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
    await useToast().success('å·²æ·»åŠ åˆ°è´­ç‰©è½¦');
  } finally {
    loading.value = false;
  }
}

// åŠ¨æ€SEO
useSeoMeta({
  title: product.value.name,
  description: product.value.description,
  ogImage: product.value.image
});
</script>
```

#### 2. å…¨æ ˆå¼€å‘èƒ½åŠ›

::code-group
```typescript [API è·¯ç”±]
// server/api/products/[id].get.ts
export default defineEventHandler(async (event) => {
  const id = getRouterParam(event, 'id');

  // æ•°æ®åº“æŸ¥è¯¢
  const product = await getProductById(id);

  if (!product) {
    throw createError({
      statusCode: 404,
      statusMessage: 'Product not found'
    });
  }

  return product;
});
```

```typescript [ä¸­é—´ä»¶]
// server/middleware/auth.ts
export default defineEventHandler(async (event) => {
  // è·³è¿‡å…¬å…±è·¯ç”±
  if (event.node.req.url?.startsWith('/api/public/')) {
    return;
  }

  // éªŒè¯ JWT token
  const token = getCookie(event, 'auth-token');
  if (!token) {
    throw createError({
      statusCode: 401,
      statusMessage: 'Unauthorized'
    });
  }

  try {
    const user = await verifyToken(token);
    event.context.user = user;
  } catch (error) {
    throw createError({
      statusCode: 401,
      statusMessage: 'Invalid token'
    });
  }
});
```
::

#### 3. è‡ªåŠ¨åŒ–æœ€ä½³å®è·µ

::tabs{variant="line"}
  ::stack{label="è‡ªåŠ¨è·¯ç”±"}
  ```text
  pages/
  â”œâ”€â”€ index.vue                    # â†’ /
  â”œâ”€â”€ about.vue                   # â†’ /about
  â”œâ”€â”€ blog/
  â”‚   â”œâ”€â”€ index.vue              # â†’ /blog
  â”‚   â”œâ”€â”€ [slug].vue             # â†’ /blog/:slug
  â”‚   â””â”€â”€ category/
  â”‚       â””â”€â”€ [name].vue         # â†’ /blog/category/:name
  â””â”€â”€ user/
      â”œâ”€â”€ index.vue              # â†’ /user
      â”œâ”€â”€ [id].vue               # â†’ /user/:id
      â””â”€â”€ [id]/
          â””â”€â”€ settings.vue       # â†’ /user/:id/settings
  ```
  ::

  ::stack{label="è‡ªåŠ¨å¯¼å…¥"]
  ```typescript
  // nuxt.config.ts
  export default defineNuxtConfig({
    // è‡ªåŠ¨å¯¼å…¥é…ç½®
    imports: {
      dirs: [
        'composables',
        'composables/*/index.{ts,js,mjs,mts}',
        'composables/**'
      ]
    },

    // ç»„ä»¶è‡ªåŠ¨å¯¼å…¥
    components: [
      {
        path: '~/components',
        pathPrefix: false,
        // å…¨å±€ç»„ä»¶
        global: true
      }
    ]
  });
  ```
  ::

  ::stack{label="ç±»å‹å®‰å…¨"]
  ```typescript
  // è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹
  declare module '#app' {
    interface NuxtApp {
      $toast: {
        success: (message: string) => void;
        error: (message: string) => void;
      };
    }
  }

  // è·¯ç”±ç±»å‹
  declare module 'vue-router' {
    interface RouteMeta {
      requiresAuth?: boolean;
      title?: string;
    }
  }
  ```
  ::
::

### 5.4 å¼€å‘ä½“éªŒå¯¹æ¯”

#### Vue 3 åŸç”Ÿå¼€å‘ vs Nuxt4 å¼€å‘

::code-group
```javascript [Vue 3 åŸç”Ÿé¡¹ç›®è®¾ç½®]
import vue from '@vitejs/plugin-vue';
import { createPinia } from 'pinia';
// éœ€è¦æ‰‹åŠ¨é…ç½®æ„å»ºå·¥å…·
// vite.config.js
import { defineConfig } from 'vite';
// main.js
import { createApp } from 'vue';

import { createRouter, createWebHistory } from 'vue-router';
import App from './App.vue';

// æ‰‹åŠ¨é…ç½®è·¯ç”±
const routes = [
  { path: '/', component: () => import('./pages/Home.vue') },
  { path: '/about', component: () => import('./pages/About.vue') }
];

const router = createRouter({
  history: createWebHistory(),
  routes
});

const pinia = createPinia();
const app = createApp(App);

app.use(router);
app.use(pinia);
app.mount('#app');

export default defineConfig({
  plugins: [vue()],
  // å¤§é‡é…ç½®...
});
```

```typescript [Nuxt4 é¡¹ç›®è®¾ç½®]
// nuxt.config.ts
export default defineNuxtConfig({
  // é›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨
  devtools: { enabled: true }
});

// é¡µé¢è‡ªåŠ¨è·¯ç”±
// pages/index.vue â†’ /
// pages/about.vue â†’ /about

// è‡ªåŠ¨å¯¼å…¥
// components/ ç›®å½•ä¸‹çš„ç»„ä»¶è‡ªåŠ¨å¯¼å…¥
// composables/ ç›®å½•ä¸‹çš„å‡½æ•°è‡ªåŠ¨å¯¼å…¥
// stores/ ç›®å½•ä¸‹çš„çŠ¶æ€ç®¡ç†è‡ªåŠ¨å¯¼å…¥
```
::

### 5.5 æŠ€æœ¯æ ˆå¯¹æ¯”

| åŠŸèƒ½ç‰¹æ€§ | Vue 3 åŸç”Ÿ | Nuxt4 |
|----------|------------|--------|
| **è·¯ç”±ç³»ç»Ÿ** | æ‰‹åŠ¨é…ç½® Vue Router | æ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨è·¯ç”± |
| **çŠ¶æ€ç®¡ç†** | æ‰‹åŠ¨é…ç½® Pinia/Vuex | è‡ªåŠ¨å¯¼å…¥ + ç±»å‹å®‰å…¨ |
| **æ„å»ºå·¥å…·** | æ‰‹åŠ¨é…ç½® Vite/Webpack | é›¶é…ç½® Vite |
| **TypeScript** | éœ€è¦é…ç½® | å¼€ç®±å³ç”¨ |
| **SSR/SSG** | éœ€è¦é¢å¤–é…ç½® | å†…ç½®å¤šç§æ¸²æŸ“æ¨¡å¼ |
| **å¼€å‘æœåŠ¡å™¨** | éœ€è¦é…ç½® | è‡ªåŠ¨é…ç½® |
| **çƒ­é‡è½½** | åŸºç¡€æ”¯æŒ | æé€Ÿçƒ­é‡è½½ |
| **SEOä¼˜åŒ–** | æ‰‹åŠ¨å¤„ç† | è‡ªåŠ¨åŒ–SEO |

### 5.6 é€‰æ‹©å»ºè®®

::card-group{cols=2}
  ::::card{icon="lucide:zap" color="green"}
  #title
  **é€‰æ‹© Nuxt4 çš„åœºæ™¯**
  #description
  - éœ€è¦ SSR/SSG çš„é¡¹ç›®
  - è¦æ±‚å¿«é€Ÿå¼€å‘è¿­ä»£
  - å›¢é˜Ÿç»éªŒç›¸å¯¹è¾ƒå°‘
  - éœ€è¦ SEO ä¼˜åŒ–
  - å…¨æ ˆå¼€å‘éœ€æ±‚
  - ä¼ä¸šçº§åº”ç”¨å¼€å‘
  ::::

  ::::card{icon="lucide:wrench" color="blue"}
  #title
  **é€‰æ‹© Vue 3 åŸç”Ÿçš„åœºæ™¯**
  #description
  - çº¯å®¢æˆ·ç«¯åº”ç”¨
  - éœ€è¦æè‡´çš„å®šåˆ¶åŒ–
  - ç°æœ‰é¡¹ç›®è¿ç§»
  - å›¢é˜Ÿæœ‰ä¸°å¯Œç»éªŒ
  - ç‰¹æ®Šçš„æ„å»ºéœ€æ±‚
  - åº“/ç»„ä»¶å¼€å‘
  ::::
::

## 6ã€Nuxt4 çš„é‡å¤§æ›´æ–°

### 6.1 æ–°çš„ç›®å½•ç»“æ„

Nuxt4 å¼•å…¥äº†å…¨æ–°çš„ `app/` ç›®å½•ç»“æ„ï¼Œæä¾›æ›´å¥½çš„ç»„ç»‡å’Œ IDE æ€§èƒ½ï¼š

```text
Nuxt4 é¡¹ç›®ç»“æ„:
â”œâ”€â”€ app/                    # æ–°å¢ï¼šåº”ç”¨ä»£ç ç›®å½•
â”‚   â”œâ”€â”€ components/         # Vue ç»„ä»¶
â”‚   â”œâ”€â”€ composables/        # ç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ layouts/           # å¸ƒå±€æ–‡ä»¶
â”‚   â”œâ”€â”€ middleware/        # è·¯ç”±ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ pages/             # é¡µé¢æ–‡ä»¶
â”‚   â”œâ”€â”€ plugins/           # æ’ä»¶
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â”œâ”€â”€ server/                # æœåŠ¡å™¨ç«¯ä»£ç 
â”œâ”€â”€ public/                # é™æ€èµ„æº
â””â”€â”€ nuxt.config.ts        # é…ç½®æ–‡ä»¶
```

::alert{icon="lucide:folder" color="blue"}
**è¿ç§»æç¤º**: ç°æœ‰çš„é¡¹ç›®ç»“æ„ä»ç„¶æœ‰æ•ˆï¼Œä½†æ¨èé€æ­¥è¿ç§»åˆ°æ–°çš„ `app/` ç›®å½•ä»¥è·å¾—æ›´å¥½çš„å¼€å‘ä½“éªŒã€‚
::

### 6.2 æ”¹è¿›çš„æ•°æ®è·å–

Nuxt4 å¯¹æ•°æ®è·å–å±‚è¿›è¡Œäº†é‡å¤§æ”¹è¿›ï¼š

#### 1. ä¸€è‡´çš„æ•°æ®çŠ¶æ€

æ‰€æœ‰ä½¿ç”¨ç›¸åŒ key çš„ `useAsyncData` æˆ– `useFetch` è°ƒç”¨ç°åœ¨å…±äº«åº•å±‚çš„ refsï¼š

```vue
<!-- ComponentA.vue -->
<script setup>
const { data: users, pending } = useAsyncData('users', fetchUsers);
</script>

<!-- ComponentB.vue -->
<script setup>
// è¿™å°†å¼•ç”¨ä¸ ComponentA ç›¸åŒçš„æ•°æ®çŠ¶æ€
const { data: users, status } = useAsyncData('users', fetchUsers);
// å½“ä»»ä¸€ç»„ä»¶åˆ·æ–°æ•°æ®æ—¶ï¼Œä¸¤è€…éƒ½ä¼šä¸€è‡´æ›´æ–°
</script>
```

#### 2. å“åº”å¼ Keys

ç°åœ¨æ”¯æŒä½¿ç”¨è®¡ç®—å±æ€§ã€ref æˆ– getter å‡½æ•°ä½œä¸º keyï¼š

```typescript
const userId = ref('123');
const { data: user } = useAsyncData(
  computed(() => `user-${userId.value}`),
  () => fetchUser(userId.value)
);

// æ”¹å˜ userId å°†è‡ªåŠ¨è§¦å‘æ–°çš„æ•°æ®è·å–
// å¦‚æœæ²¡æœ‰å…¶ä»–ç»„ä»¶ä½¿ç”¨æ—§æ•°æ®ï¼Œä¼šè‡ªåŠ¨æ¸…ç†
userId.value = '456';
```

### 6.3 å¢å¼ºçš„å†…ç½®ç»„ä»¶

#### 1. æ–°çš„ `<NuxtTime>` ç»„ä»¶

SSR å®‰å…¨çš„æ—¶é—´æ˜¾ç¤ºç»„ä»¶ï¼Œè§£å†³æ—¥æœŸå¤„ç†çš„æ°´åˆä¸åŒ¹é…é—®é¢˜ï¼š

```vue
<template>
  <div>
    <!-- åŸºç¡€ç”¨æ³• -->
    <NuxtTime :datetime="Date.now()" />

    <!-- è‡ªå®šä¹‰æ ¼å¼ -->
    <NuxtTime
      :datetime="post.createdAt"
      :format="{
        year: 'numeric',
        month: 'long',
        day: 'numeric',
      }"
    />
  </div>
</template>
```

#### 2. å¢å¼ºçš„ `<NuxtErrorBoundary>`

æä¾›æ›´å¥½çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶ï¼š

```vue
<NuxtErrorBoundary @error="handleError">
  <template #error="{ error, clearError }">
    <div class="error-container">
      <h2>å‡ºé”™äº†!</h2>
      <p>{{ error.message }}</p>
      <button @click="clearError">é‡è¯•</button>
    </div>
  </template>

  <!-- å¯èƒ½å‡ºé”™çš„å†…å®¹ -->
  <MyComponent />
</NuxtErrorBoundary>
```

### 6.4 æ€§èƒ½ä¼˜åŒ–

#### 1. æ”¹è¿›çš„æ„å»ºæ€§èƒ½

- åˆ‡æ¢åˆ° `tinyglobby` å®ç°æ›´å¿«çš„æ–‡ä»¶åŒ¹é…
- æ’é™¤ `.data` ç›®å½•è¿›è¡Œç±»å‹æ£€æŸ¥
- æ”¹è¿›çš„ tree-shaking æœºåˆ¶

#### 2. è¿è¡Œæ—¶ä¼˜åŒ–

- ä¼˜åŒ–çš„æ•°æ®é‡æ–°è·å–æœºåˆ¶
- å‡å°‘å†…å­˜å ç”¨
- æ›´æ™ºèƒ½çš„ç¼“å­˜ç­–ç•¥

```typescript
// è‡ªåŠ¨ä¼˜åŒ–çš„æ•°æ®è·å–
const { data } = useAsyncData(
  'users',
  () => $fetch(`/api/users?page=${route.query.page}`),
  { watch: [() => route.query.page] }
);

// å½“ route.query.page æ”¹å˜æ—¶ï¼Œåªä¼šå‘ç”Ÿä¸€æ¬¡è·å–æ“ä½œ
// æ‰€æœ‰ä½¿ç”¨æ­¤ key çš„ç»„ä»¶ä¼šåŒæ—¶æ›´æ–°
```

### 6.5 å¼€å‘ä½“éªŒæ”¹è¿›

#### 1. æ›´å¥½çš„è­¦å‘Šç³»ç»Ÿ

- æœåŠ¡å™¨ç»„ä»¶ç¼ºå°‘æ ¹å…ƒç´ æ—¶çš„è­¦å‘Š
- ä½¿ç”¨ä¿ç•™ `runtimeConfig.app` å‘½åç©ºé—´æ—¶çš„è­¦å‘Š
- é‡å†™æ ¸å¿ƒè‡ªåŠ¨å¯¼å…¥é¢„è®¾æ—¶çš„è­¦å‘Š

#### 2. å¢å¼ºçš„æ¨¡å—å¼€å‘

```typescript
// æ–°çš„æ¨¡å—å…¼å®¹æ€§æ£€æŸ¥
export default defineNuxtConfig({
  experimental: {
    enforceModuleCompatibility: true // Nuxt v4 ä¸­é»˜è®¤å¯ç”¨
  }
});

// è‡ªåŠ¨æ³¨å†Œç»„ä»¶å¯¼å‡º
export default defineNuxtModule({
  setup(options, nuxt) {
    // è‡ªåŠ¨æ³¨å†Œæ–‡ä»¶ä¸­çš„æ‰€æœ‰å‘½åå¯¼å‡ºç»„ä»¶
    addComponentExports({
      filePath: '~/components/MyComponents.ts'
    });
  }
});
```

## 7ã€æ€»ç»“

é€šè¿‡æœ¬ç« å­¦ä¹ ï¼Œå…¨é¢äº†è§£äº†ï¼š

### 7.1 æ ¸å¿ƒçŸ¥è¯†ç‚¹
- **Nuxt4 å½“å‰çŠ¶æ€** - Alpha ç‰ˆæœ¬å·²å‘å¸ƒï¼Œç¨³å®šç‰ˆé¢„è®¡ 2025 å¹´åº•
- **æµ‹è¯•æ–¹æ³•** - å…¼å®¹æ€§æ ‡å¿—å’Œ Alpha ç‰ˆæœ¬å®‰è£…
- **æ ¸å¿ƒç‰¹æ€§** - å¤šç§æ¸²æŸ“æ¨¡å¼ã€è‡ªåŠ¨å¯¼å…¥ã€æ™ºèƒ½ç¼“å­˜ç­‰
- **é‡å¤§æ›´æ–°** - æ–°ç›®å½•ç»“æ„ã€æ”¹è¿›æ•°æ®è·å–ã€å¢å¼ºç»„ä»¶
- **æŠ€æœ¯ä¼˜åŠ¿** - å¼€å‘ä½“éªŒã€æ€§èƒ½è¡¨ç°ã€æ¶æ„è®¾è®¡çš„å…¨é¢æå‡
- **ä¸ Vue3 å…³ç³»** - æ·±åº¦é›†æˆã€æ‰©å±•å¢å¼ºã€æœ€ä½³å®è·µ

### 7.2 å®ç”¨æŠ€èƒ½
- ç†è§£ Nuxt4 çš„æ ¸å¿ƒä»·å€¼å’Œé€‚ç”¨åœºæ™¯
- æŒæ¡å¦‚ä½•æµ‹è¯•å’Œä½“éªŒ Nuxt4 æ–°ç‰¹æ€§
- äº†è§£ Nuxt4 ç›¸æ¯” Vue 3 åŸç”Ÿå¼€å‘çš„ä¼˜åŠ¿
- å…·å¤‡æŠ€æœ¯é€‰å‹çš„å†³ç­–èƒ½åŠ›
- ç†Ÿæ‚‰ Nuxt4 çš„å¼€å‘æ¨¡å¼å’Œæœ€ä½³å®è·µ

### 7.3 è¿ç§»å‡†å¤‡
- äº†è§£æ–°çš„ `app/` ç›®å½•ç»“æ„
- æŒæ¡æ”¹è¿›çš„æ•°æ®è·å–æœºåˆ¶
- ç†Ÿæ‚‰å¢å¼ºçš„å†…ç½®ç»„ä»¶
- ç†è§£æ€§èƒ½ä¼˜åŒ–æ”¹è¿›
- å‡†å¤‡é€æ­¥è¿ç§»ç­–ç•¥

::alert{icon="lucide:rocket" color="green"}
**å±•æœ›æœªæ¥**: Nuxt 4 å¸¦æ¥äº†æ¿€åŠ¨äººå¿ƒçš„æ”¹è¿›ï¼Œå»ºè®®åœ¨å¼€å‘ç¯å¢ƒä¸­æµ‹è¯•æ–°ç‰¹æ€§ï¼Œä¸ºæœªæ¥çš„æ­£å¼è¿ç§»åšå¥½å‡†å¤‡ã€‚
::

## ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ 
æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ·±å…¥å­¦ä¹  Nuxt4 çš„å¼€å‘ç¯å¢ƒæ­å»ºï¼Œè®©ä½ å¿«é€Ÿä¸Šæ‰‹ Nuxt4 å¼€å‘ã€‚
