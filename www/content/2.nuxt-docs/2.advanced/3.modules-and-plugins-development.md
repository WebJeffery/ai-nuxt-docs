---
title: Nuxt æ¨¡å—ç³»ç»Ÿä¸æ’ä»¶å¼€å‘
description: æ·±åº¦è§£æ Nuxt æ¨¡å—ç³»ç»Ÿä¸æ’ä»¶å¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§åº”ç”¨ï¼Œæ¶µç›–æ¨¡å—æ¶æ„ã€ç”Ÿå‘½å‘¨æœŸã€æ’ä»¶æœºåˆ¶ã€å¼€å‘æœ€ä½³å®è·µï¼Œè€…æŒæ¡ Nuxt ç”Ÿæ€ç³»ç»Ÿçš„æ‰©å±•å¼€å‘èƒ½åŠ›
icon: 'lucide:puzzle'
---

## æ¦‚è¿°

Nuxt æ¡†æ¶çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶é«˜åº¦å¯æ‰©å±•çš„æ¨¡å—åŒ–æ¶æ„ã€‚æ¨¡å—ç³»ç»Ÿå’Œæ’ä»¶æœºåˆ¶æ˜¯ Nuxt ç”Ÿæ€ç³»ç»Ÿçš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œå®ƒä»¬è®©å¼€å‘è€…èƒ½å¤Ÿä»¥ä¼˜é›…çš„æ–¹å¼æ‰©å±•å’Œå®šåˆ¶æ¡†æ¶åŠŸèƒ½ã€‚ä»ç®€å•çš„å·¥å…·å‡½æ•°åˆ°å¤æ‚çš„å…¨æ ˆè§£å†³æ–¹æ¡ˆï¼Œæ¨¡å—å’Œæ’ä»¶æä¾›äº†æ— é™çš„å¯èƒ½æ€§ã€‚


### ğŸ¯ å­¦ä¹ ç›®æ ‡

- æ·±å…¥ç†è§£ Nuxt æ¨¡å—ç³»ç»Ÿçš„æ¶æ„åŸç†å’Œå·¥ä½œæœºåˆ¶
- æŒæ¡è‡ªå®šä¹‰æ¨¡å—å¼€å‘çš„å®Œæ•´æµç¨‹å’Œæœ€ä½³å®è·µ
- å­¦ä¹ æ’ä»¶ç³»ç»Ÿçš„è®¾è®¡æ¨¡å¼å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†
- å­¦ä¼šæ„å»ºä¼ä¸šçº§å¯å¤ç”¨æ¨¡å—å’Œæ’ä»¶è§£å†³æ–¹æ¡ˆ

### ğŸ’¡ æŠ€æœ¯æ¶æ„ä½“ç³»

- **@nuxt/kit**: æ¨¡å—å¼€å‘å·¥å…·åŒ…å’Œ API é›†åˆ
- **unjs ç”Ÿæ€ç³»ç»Ÿ**: åº•å±‚å·¥å…·é“¾å’Œæ ‡å‡†åŒ–æ¥å£
- **æ’ä»¶ç³»ç»Ÿ**: è¿è¡Œæ—¶æ‰©å±•å’ŒåŠŸèƒ½æ³¨å…¥æœºåˆ¶
- **ç”Ÿå‘½å‘¨æœŸé’©å­**: æ„å»ºæ—¶å’Œè¿è¡Œæ—¶çš„äº‹ä»¶ç³»ç»Ÿ
- **æ¨¡å—æ³¨å†Œæœºåˆ¶**: è‡ªåŠ¨å‘ç°ã€ä¾èµ–ç®¡ç†å’Œé…ç½®åˆå¹¶

::alert{icon="lucide:lightbulb" color="blue"}
**æ¶æ„è®¾è®¡ç†å¿µ**: Nuxt çš„æ¨¡å—ç³»ç»ŸåŸºäº"æ¸è¿›å¼å¢å¼º"å’Œ"çº¦å®šä¼˜äºé…ç½®"çš„è®¾è®¡åŸåˆ™ï¼Œé€šè¿‡æ ‡å‡†åŒ–çš„ API å’Œè‡ªåŠ¨åŒ–çš„æ„å»ºæµç¨‹ï¼Œå®ç°åŠŸèƒ½çš„æ— ç¼é›†æˆå’Œé«˜æ•ˆå¤ç”¨ã€‚
::

## Nuxt æ¨¡å—ç³»ç»Ÿæ·±åº¦è§£æ

### æ¨¡å—çš„æ¦‚å¿µä¸ä½œç”¨

#### æ¨¡å—ç³»ç»Ÿæ¶æ„åŸç†

Nuxt æ¨¡å—æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œå‡½æ•°ï¼Œå®ƒåœ¨æ„å»ºæ—¶è¿è¡Œå¹¶å¯ä»¥æ‰©å±• Nuxt æ ¸å¿ƒåŠŸèƒ½ã€‚æ¨¡å—ç³»ç»ŸåŸºäºä»¥ä¸‹æ ¸å¿ƒæ¦‚å¿µï¼š

```typescript
// æ¨¡å—å®šä¹‰çš„åŸºæœ¬ç»“æ„
import { defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  // æ¨¡å—å…ƒæ•°æ®
  meta: {
    name: 'my-awesome-module',
    configKey: 'myModule',
    compatibility: {
      nuxt: '^3.0.0'
    }
  },
  
  // é»˜è®¤é…ç½®é€‰é¡¹
  defaults: {
    enabled: true,
    apiEndpoint: '/api/data'
  },
  
  // æ¨¡å—æ ¸å¿ƒé€»è¾‘
  setup(options, nuxt) {
    // æ¨¡å—åˆå§‹åŒ–é€»è¾‘
    console.log('Module initialized with options:', options)
    
    // è®¿é—® Nuxt å®ä¾‹è¿›è¡Œæ‰©å±•
    nuxt.hook('ready', () => {
      console.log('Nuxt application is ready!')
    })
  }
})
```

#### æ¨¡å—ç±»å‹åˆ†ç±»ä¸ä½¿ç”¨åœºæ™¯

**åŠŸèƒ½æ‰©å±•æ¨¡å—**
```typescript
// ç¤ºä¾‹ï¼šAPI ç¼“å­˜æ¨¡å—
export default defineNuxtModule({
  meta: {
    name: 'nuxt-api-cache',
    configKey: 'apiCache'
  },
  defaults: {
    ttl: 3600,
    storage: 'memory'
  },
  setup(options, nuxt) {
    // æ·»åŠ æœåŠ¡ç«¯ä¸­é—´ä»¶
    addServerHandler({
      route: '/api/**',
      handler: createCacheHandler(options)
    })
    
    // æ³¨å†Œç¼“å­˜æ¸…ç†ä»»åŠ¡
    nuxt.hook('close', () => {
      clearCache()
    })
  }
})
```

**UI ç»„ä»¶æ¨¡å—**
```typescript
// ç¤ºä¾‹ï¼šUI ç»„ä»¶åº“æ¨¡å—
export default defineNuxtModule({
  meta: {
    name: 'nuxt-ui-components',
    configKey: 'uiComponents'
  },
  setup(options, nuxt) {
    const { resolve } = createResolver(import.meta.url)
    
    // è‡ªåŠ¨æ³¨å†Œç»„ä»¶
    addComponentsDir({
      path: resolve('./runtime/components'),
      prefix: 'Ui',
      global: true
    })
    
    // æ·»åŠ æ ·å¼æ–‡ä»¶
    addTemplate({
      filename: 'ui-components.css',
      src: resolve('./runtime/styles/main.css')
    })
    
    // æ³¨å…¥å…¨å±€æ ·å¼
    nuxt.options.css.push('#build/ui-components.css')
  }
})
```

**å·¥å…·é›†æˆæ¨¡å—**
```typescript
// ç¤ºä¾‹ï¼šç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆæ¨¡å—
export default defineNuxtModule({
  meta: {
    name: 'nuxt-analytics',
    configKey: 'analytics'
  },
  defaults: {
    trackingId: '',
    enableInDev: false
  },
  setup(options, nuxt) {
    // éªŒè¯å¿…è¦é…ç½®
    if (!options.trackingId) {
      throw new Error('Analytics tracking ID is required')
    }
    
    // åªåœ¨ç”Ÿäº§ç¯å¢ƒæˆ–å¼€å‘ç¯å¢ƒå…è®¸æ—¶åŠ è½½
    if (nuxt.options.dev && !options.enableInDev) {
      return
    }
    
    // æ·»åŠ å®¢æˆ·ç«¯æ’ä»¶
    addPlugin({
      src: resolve('./runtime/plugin.client.ts'),
      mode: 'client'
    })
    
    // æ³¨å…¥é…ç½®åˆ°è¿è¡Œæ—¶
    nuxt.options.runtimeConfig.public.analytics = {
      trackingId: options.trackingId
    }
  }
})
```

### @nuxt/image æ¨¡å—

**@nuxt/image æ¨¡å—ä½¿ç”¨é…ç½®**

```typescript
// nuxt.config.ts - å›¾åƒä¼˜åŒ–æ¨¡å—é…ç½®
export default defineNuxtConfig({
  modules: ['@nuxt/image'],
  
  image: {
    // å¤šæä¾›å•†é…ç½®
    providers: {
      cloudinary: {
        baseURL: 'https://res.cloudinary.com/demo/image/fetch/'
      },
      imgix: {
        baseURL: 'https://assets.imgix.net/'
      }
    },
    
    // é¢„è®¾é…ç½®
    presets: {
      avatar: {
        modifiers: {
          format: 'webp',
          width: 50,
          height: 50,
          quality: 80
        }
      },
      cover: {
        modifiers: {
          format: 'webp',
          width: 800,
          height: 600,
          fit: 'cover'
        }
      }
    },
    
    // å…¨å±€é…ç½®
    screens: {
      xs: 320,
      sm: 640,
      md: 768,
      lg: 1024,
      xl: 1280,
      xxl: 1536
    },
    
    // åŸŸåé…ç½®
    domains: ['example.com', 'images.unsplash.com']
  }
})
```

#### æ ¸å¿ƒæ¶æ„è®¾è®¡
@nuxt/image æ¨¡å—åŸºäº Nuxt çš„æ¨¡å—åŒ–æ¶æ„å’Œç°ä»£å›¾åƒå¤„ç†æœ€ä½³å®è·µæ„å»ºï¼Œå…¶æ ¸å¿ƒå®ç°åŒ…å«ä»¥ä¸‹å…³é”®å±‚ï¼š

```typescript
/**
 * Nuxt å›¾åƒæ¨¡å—æ ¸å¿ƒæ¶æ„å®šä¹‰
 * 
 * é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œå®ç°å›¾åƒå¤„ç†èƒ½åŠ›çš„æ¨¡å—åŒ–æ‰©å±•å’Œè¿è¡Œæ—¶ä¼˜åŒ–
 */
interface ModuleArchitecture {
  /** 
   * æä¾›è€…æŠ½è±¡å±‚ - è´Ÿè´£ä¸åŒå›¾åƒæœåŠ¡æä¾›å•†çš„é€‚é…å·¥ä½œ
   * @property abstract - å›¾åƒæä¾›è€…æŠ½è±¡æ¥å£å®šä¹‰
   * @property implementations - å…·ä½“æä¾›å•†å®ç°ï¼ˆç¤ºä¾‹åŒ…å« Cloudinary/Imgix/Static ä¸‰ç§ç±»å‹ï¼‰
   */
  providerLayer: {
    abstract: ImageProvider
    implementations: CloudinaryProvider | ImgixProvider | StaticProvider
  }

  /**
   * è¿è¡Œæ—¶å¤„ç†å±‚ - è´Ÿè´£å®¢æˆ·ç«¯å›¾åƒè½¬æ¢å’Œä¼˜åŒ–é€»è¾‘
   * @property imageTransformation - å›¾åƒè½¬æ¢æ ¸å¿ƒåŠŸèƒ½
   * @property optimizationEngine - æ™ºèƒ½ä¼˜åŒ–å¼•æ“
   */
  runtimeLayer: {
    imageTransformation: {
      urlGenerator: (options: ImageOptions) => string // æ ¹æ®é…ç½®ç”Ÿæˆä¼˜åŒ–åçš„å›¾ç‰‡URL
      srcsetGenerator: (breakpoints: number[]) => string // ç”Ÿæˆå“åº”å¼å›¾ç‰‡çš„srcsetå±æ€§
    }
    optimizationEngine: {
      formatConversion: 'webp' | 'avif' // è‡ªåŠ¨æ ¼å¼è½¬æ¢ç­–ç•¥ï¼ˆä¼˜å…ˆç°ä»£å›¾ç‰‡æ ¼å¼ï¼‰
      qualityPresets: Map<string, number> // è´¨é‡é¢„è®¾é…ç½®ï¼ˆå¦‚ï¼š{ 'thumbnail': 80, 'high': 95 }ï¼‰
    }
  }

  /**
   * Nitro æœåŠ¡é›†æˆå±‚ - æœåŠ¡ç«¯å›¾åƒå¤„ç†ç›¸å…³åŠŸèƒ½
   * @property devMiddleware - å¼€å‘ç¯å¢ƒä¸­é—´ä»¶ï¼ˆç”¨äºå®æ—¶å›¾åƒå¤„ç†ï¼‰
   * @property productionHandler - ç”Ÿäº§ç¯å¢ƒè¯·æ±‚å¤„ç†å™¨ï¼ˆå¯¹æ¥CDNæˆ–å­˜å‚¨æœåŠ¡ï¼‰
   * @property cacheStorage - ç¼“å­˜å­˜å‚¨ç­–ç•¥ï¼ˆæ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æˆ–å†…å­˜å­˜å‚¨ï¼‰
   */
  nitroIntegration: {
    devMiddleware: ImageMiddleware
    productionHandler: ImageEndpoint
    cacheStorage: FSStorage | MemoryStorage
  }
}
```

#### æ ¸å¿ƒå®ç°æœºåˆ¶

```ts

/**
 * @nuxt/image æ ¸å¿ƒå®ç°æµç¨‹ï¼š
 * 
 * 1. æ¨¡å—åˆå§‹åŒ–é˜¶æ®µï¼š
 * - è¯»å–nuxt.configä¸­çš„å›¾åƒé…ç½®
 * - æ³¨å†Œå›¾åƒæä¾›è€…ï¼ˆCloudinary/Imgixç­‰ï¼‰
 * - æ³¨å…¥è¿è¡Œæ—¶ç»„ä»¶å’Œå·¥å…·æ–¹æ³•
 */
export default defineNuxtModule<ModuleOptions>({
  meta: {
    name: 'nuxt-image',
    configKey: 'image'
  },
  setup(options, nuxt) {
    // æ³¨å†Œå›¾åƒæä¾›è€…
    const provider = createImageProvider(options.provider)
    
    // æ³¨å…¥è¿è¡Œæ—¶å·¥å…·
    nuxt.hook('imports:extend', (imports) => {
      imports.push({ name: 'useImage', as: 'useImage', from: '#image' })
    })
  }
})

/**
 * 2. è¿è¡Œæ—¶å¤„ç†æµç¨‹ï¼š
 * - è§£æç»„ä»¶å±æ€§ï¼ˆ<NuxtImg> / <NuxtPicture>ï¼‰
 * - æ ¹æ®è®¾å¤‡ç‰¹æ€§ç”Ÿæˆä¼˜åŒ–å‚æ•°
 * - æ„å»ºæä¾›è€…ç‰¹å®šçš„å›¾ç‰‡URL
 */
function createImageURL(src: string, modifiers: ImageModifiers) {
  // 1. åº”ç”¨å…¨å±€é»˜è®¤é…ç½®
  const mergedModifiers = { ...defaults, ...modifiers }
  
  // 2. è®¾å¤‡é€‚é…å¤„ç†
  applyDeviceAdaptation(mergedModifiers)
  
  // 3. ç”Ÿæˆæä¾›è€…ç‰¹å®šURL
  return provider.generateURL(src, mergedModifiers)
}

/**
 * 3. æœåŠ¡ç«¯é›†æˆæµç¨‹ï¼š
 * - å¼€å‘æ¨¡å¼ä¸‹æ³¨å†Œå›¾ç‰‡ä¼˜åŒ–ä¸­é—´ä»¶
 * - ç”Ÿäº§ç¯å¢ƒé…ç½®CDNè·¯ç”±è§„åˆ™
 * - ç¼“å­˜ç­–ç•¥ç®¡ç†
 */
nuxt.hook('nitro:config', (nitroConfig) => {
  if (process.env.NODE_ENV === 'development') {
    nitroConfig.handlers.push({
      route: '/_image/development/**',
      handler: '#image/devHandler'
    })
  }
})

/**
 * 4. æ„å»ºä¼˜åŒ–é˜¶æ®µï¼š
 * - å›¾ç‰‡èµ„æºæ‰«æä¸é¢„å¤„ç†
 * - ç”Ÿæˆå“åº”å¼å›¾ç‰‡çš„srcset
 * - ç”Ÿæˆç°ä»£å›¾ç‰‡æ ¼å¼çš„fallback
 */
nuxt.hook('build:before', () => {
  analyzeImages().then((assets) => {
    generateResponsiveVariants(assets)
    generateFormatFallbacks()
  })
})

```

::alert{icon="lucide:lightbulb" color="blue"}
**æ¶æ„è®¾è®¡äº®ç‚¹**ï¼š
1. **åˆ†å±‚æ¶æ„**ï¼šè§£è€¦æä¾›è€…å®ç°ã€è¿è¡Œæ—¶å¤„ç†å’ŒæœåŠ¡ç«¯é€»è¾‘
2. **æ··åˆæ¸²æŸ“æ”¯æŒ**ï¼šåŒæ—¶å…¼å®¹ SSRã€SSG å’Œ CSR åœºæ™¯
3. **æ™ºèƒ½ç¼“å­˜**ï¼šå¤šçº§ç¼“å­˜ç­–ç•¥å…¼é¡¾å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒéœ€æ±‚
4. **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ä¿éšœå¼€å‘ä½“éªŒ
5. **å¯æ‰©å±•æ€§**ï¼šé€šè¿‡æä¾›è€…æ¥å£è½»æ¾æ‰©å±•æ–°å›¾åƒæœåŠ¡
::


### @pinia/nuxt çŠ¶æ€ç®¡ç†



**@pinia/nuxt çŠ¶æ€ç®¡ç†é…ç½®**
```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  modules: ['@pinia/nuxt'],
  
  pinia: {
    storesDirs: ['./stores/**', './custom-folder/stores/**'],
    autoImports: ['defineStore', 'acceptHMRUpdate']
  }
})
```

**@pinia/nuxt** ä½¿ç”¨ç¤ºä¾‹

```typescript
// ç¤ºä¾‹ï¼šç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†
// stores/auth.ts
import { defineStore } from 'pinia'

export const useAuthStore = defineStore('auth', {
  state: () => ({
    user: null as User | null,
    token: '',
    expiresAt: 0
  }),
  
  actions: {
    async login(credentials: LoginPayload) {
      const { data } = await useFetch('/api/auth/login', {
        method: 'POST',
        body: credentials
      })
      
      if (data.value) {
        this.user = data.value.user
        this.token = data.value.token
        this.expiresAt = data.value.expiresAt
      }
    },
    
    logout() {
      this.$reset()
      useCookie('auth_token').value = null
    }
  },
  
  getters: {
    isAuthenticated: (state) => state.expiresAt > Date.now()
  }
})

// ç»„ä»¶ä¸­ä½¿ç”¨
const auth = useAuthStore()
```

#### æ ¸å¿ƒå®ç°æœºåˆ¶

```ts
/**
 * @pinia/nuxt æ¨¡å—æ ¸å¿ƒæ¶æ„ï¼š
 * 
 * 1. æ¨¡å—æ³¨å†Œé˜¶æ®µï¼š
 * - è‡ªåŠ¨æ³¨å†Œ Pinia åˆ° Nuxt åº”ç”¨
 * - é…ç½® Vue æ’ä»¶å’Œ SSR æ”¯æŒ
 * - è®¾ç½®è‡ªåŠ¨å¯¼å…¥ç›®å½• (stores/*)
 */
export default defineNuxtModule({
  meta: {
    name: 'pinia',
    configKey: 'pinia'
  },
  
  setup(options, nuxt) {
    // æ·»åŠ  Pinia ç±»å‹å®šä¹‰
    nuxt.hook('prepare:types', ({ references }) => {
      references.push({ types: 'pinia' })
    })
    
    // æ³¨å†Œ Pinia Vue æ’ä»¶
    nuxt.hook('modules:done', () => {
      addVuePlugin(Pinia.createPinia())
    })
    
    // é…ç½®è‡ªåŠ¨å¯¼å…¥
    extendPages((pages) => {
      pages.push({
        name: 'stores',
        path: resolve(nuxt.options.srcDir, 'stores'),
        prefix: 'use',
        pattern: '**/*.ts'
      })
    })
    
    // SSR çŠ¶æ€åºåˆ—åŒ–å¤„ç†
    nuxt.hook('app:rendered', ({ ssrContext }) => {
      if (ssrContext) {
        ssrContext.payload.pinia = pinia.state.value
      }
    })
  }
})
```

#### æ ¸å¿ƒç‰¹æ€§å®ç°åŸç†

1. **è‡ªåŠ¨å¯¼å…¥æœºåˆ¶**  
é€šè¿‡æ‰«æ `stores/` ç›®å½•è‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰ï¼Œå¹¶æ³¨å†Œå…¨å±€å¯è®¿é—®çš„ store å®ä¾‹

2. **SSR æ”¯æŒ**  
```typescript
// æœåŠ¡ç«¯çŠ¶æ€åºåˆ—åŒ–
nuxt.hook('vue:setup', () => {
  if (process.server) {
    const pinia = usePinia()
    nuxt.payload.pinia = pinia.state.value
  }
})

// å®¢æˆ·ç«¯çŠ¶æ€æ°´åˆ
if (process.client && nuxt.payload.pinia) {
  const pinia = usePinia()
  pinia.state.value = nuxt.payload.pinia
}
```

3. **TypeScript æ”¯æŒ**  
é€šè¿‡ `@pinia/nuxt` çš„ç±»å‹æ‰©å±•è‡ªåŠ¨åˆå¹¶ store å®šä¹‰åˆ° Nuxt åº”ç”¨ç±»å‹ç³»ç»Ÿ

4. **æ¨¡å—é›†æˆ**  

ä¸ Nuxt çš„æ¨¡å—ç³»ç»Ÿæ·±åº¦æ•´åˆï¼Œæ”¯æŒï¼š
- è‡ªåŠ¨æ³¨å†Œ store å®ä¾‹
- å¼€å‘å·¥å…·é›†æˆï¼ˆVue DevToolsï¼‰
- ä¸ useAsyncData ç­‰ Nuxt API æ— ç¼åä½œ
- æœåŠ¡ç«¯æ¸²æŸ“çŠ¶æ€ä¿æŒ

### @nuxtjs/tailwindcss

**@nuxtjs/tailwindcss é«˜çº§é…ç½®**
```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  modules: ['@nuxtjs/tailwindcss'],
  
  tailwindcss: {
    cssPath: '~/assets/css/tailwind.css',
    configPath: 'tailwind.config.js',
    exposeConfig: true,
    viewer: true,
    // ä»…åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨ JIT
    jit: true
  }
})

// tailwind.config.js - ä¼ä¸šçº§é…ç½®
module.exports = {
  content: [
    './components/**/*.{js,vue,ts}',
    './layouts/**/*.vue',
    './pages/**/*.vue',
    './plugins/**/*.{js,ts}',
    './app.vue'
  ],
  
  theme: {
    extend: {
      // è‡ªå®šä¹‰é¢œè‰²ç³»ç»Ÿ
      colors: {
        primary: {
          50: '#f0f9ff',
          500: '#3b82f6',
          900: '#1e3a8a',
        },
        gray: {
          50: '#f9fafb',
          900: '#111827',
        }
      },
      
      // è‡ªå®šä¹‰å­—ä½“
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
        mono: ['JetBrains Mono', 'monospace']
      },
      
      // è‡ªå®šä¹‰é—´è·
      spacing: {
        '18': '4.5rem',
        '88': '22rem'
      },
      
      // è‡ªå®šä¹‰åŠ¨ç”»
      animation: {
        'fade-in': 'fadeIn 0.5s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out'
      },
      
      keyframes: {
        fadeIn: {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' }
        },
        slideUp: {
          '0%': { transform: 'translateY(100%)' },
          '100%': { transform: 'translateY(0)' }
        }
      }
    },
  },
  
  plugins: [
    require('@tailwindcss/forms'),
    require('@tailwindcss/typography'),
    require('@tailwindcss/aspect-ratio')
  ]
}
```

### 7.1.3 ç¬¬ä¸‰æ–¹æ¨¡å—é›†æˆç­–ç•¥

#### æ¨¡å—å…¼å®¹æ€§è¯„ä¼°

```typescript
// utils/module-compatibility.ts
interface ModuleCompatibility {
  nuxtVersion: string
  nodeVersion: string
  dependencies: Record<string, string>
  conflicts: string[]
}

export const checkModuleCompatibility = (
  moduleName: string, 
  moduleVersion: string
): Promise<ModuleCompatibility> => {
  return new Promise(async (resolve, reject) => {
    try {
      // æ£€æŸ¥æ¨¡å—å…ƒæ•°æ®
      const modulePackage = await import(`${moduleName}/package.json`)
      const compatibility = modulePackage.nuxt || {}
      
      // éªŒè¯ Nuxt ç‰ˆæœ¬å…¼å®¹æ€§
      const nuxtVersion = process.env.NUXT_VERSION || '3.0.0'
      if (!semver.satisfies(nuxtVersion, compatibility.nuxt || '*')) {
        throw new Error(`Module ${moduleName} is not compatible with Nuxt ${nuxtVersion}`)
      }
      
      resolve({
        nuxtVersion: compatibility.nuxt,
        nodeVersion: compatibility.node || '>= 16.0.0',
        dependencies: modulePackage.peerDependencies || {},
        conflicts: compatibility.conflicts || []
      })
    } catch (error) {
      reject(error)
    }
  })
}
```

#### ç¬¬ä¸‰æ–¹æ¨¡å—å®‰å…¨é›†æˆ

```typescript
// plugins/secure-module-loader.ts
export default defineNuxtPlugin(async () => {
  const config = useRuntimeConfig()
  
  // å®‰å…¨æ¨¡å—åŠ è½½å™¨
  const loadSecureModule = async (moduleName: string, options: any = {}) => {
    try {
      // éªŒè¯æ¨¡å—æ¥æº
      if (!config.app.trustedModules.includes(moduleName)) {
        console.warn(`Module ${moduleName} is not in trusted list`)
        return null
      }
      
      // åŠ¨æ€å¯¼å…¥æ¨¡å—
      const module = await import(moduleName)
      
      // æ²™ç›’ç¯å¢ƒåˆå§‹åŒ–
      const sandboxOptions = {
        ...options,
        sandbox: true,
        permissions: config.app.modulePermissions[moduleName] || {}
      }
      
      return module.default(sandboxOptions)
    } catch (error) {
      console.error(`Failed to load module ${moduleName}:`, error)
      return null
    }
  }
  
  return {
    provide: {
      loadSecureModule
    }
  }
})
```

#### æ¨¡å—é…ç½®ç®¡ç†ç­–ç•¥

```typescript
// composables/useModuleConfig.ts
export const useModuleConfig = <T = any>(moduleName: string) => {
  const nuxtApp = useNuxtApp()
  const runtimeConfig = useRuntimeConfig()
  
  // è·å–æ¨¡å—é…ç½®
  const getConfig = (): T => {
    const appConfig = nuxtApp.$config[moduleName]
    const runtimeModuleConfig = runtimeConfig[moduleName]
    const envConfig = process.env[`NUXT_${moduleName.toUpperCase()}`]
    
    // é…ç½®ä¼˜å…ˆçº§: ç¯å¢ƒå˜é‡ > è¿è¡Œæ—¶é…ç½® > åº”ç”¨é…ç½®
    return {
      ...appConfig,
      ...runtimeModuleConfig,
      ...(envConfig ? JSON.parse(envConfig) : {})
    } as T
  }
  
  // ç›‘å¬é…ç½®å˜åŒ–
  const configRef = ref<T>(getConfig())
  
  const updateConfig = (newConfig: Partial<T>) => {
    configRef.value = { ...configRef.value, ...newConfig }
    
    // è§¦å‘æ¨¡å—é‡æ–°åˆå§‹åŒ–
    nuxtApp.hooks.callHook('module:config:updated', moduleName, configRef.value)
  }
  
  return {
    config: readonly(configRef),
    updateConfig,
    refresh: () => { configRef.value = getConfig() }
  }
}
```

## 7.2 è‡ªå®šä¹‰æ¨¡å—å¼€å‘æ·±åº¦å®è·µ

### 7.2.1 æ¨¡å—ç»“æ„ä¸è§„èŒƒ

#### æ ‡å‡†æ¨¡å—ç›®å½•ç»“æ„

```
my-nuxt-module/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ module.ts              # æ¨¡å—å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ runtime/
â”‚       â”œâ”€â”€ components/        # è¿è¡Œæ—¶ç»„ä»¶
â”‚       â”œâ”€â”€ composables/       # ç»„åˆå¼å‡½æ•°
â”‚       â”œâ”€â”€ plugins/           # è¿è¡Œæ—¶æ’ä»¶
â”‚       â”œâ”€â”€ server/            # æœåŠ¡ç«¯ä»£ç 
â”‚       â””â”€â”€ types.ts           # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ playground/                # å¼€å‘æµ‹è¯•ç¯å¢ƒ
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”œâ”€â”€ build.config.ts            # æ„å»ºé…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

#### é«˜çº§æ¨¡å—å¼€å‘ç¤ºä¾‹

```typescript
// src/module.ts - å®Œæ•´çš„æ¨¡å—å¼€å‘ç¤ºä¾‹
import { 
  defineNuxtModule, 
  createResolver, 
  addPlugin,
  addServerHandler,
  addComponentsDir,
  addImports,
  addTemplate,
  installModule
} from '@nuxt/kit'
import { defu } from 'defu'

export interface ModuleOptions {
  enabled: boolean
  apiKey: string
  endpoint: string
  enableLogging: boolean
  cacheStrategy: 'memory' | 'redis' | 'filesystem'
  rateLimit: {
    enabled: boolean
    requests: number
    window: number
  }
}

export default defineNuxtModule<ModuleOptions>({
  meta: {
    name: 'nuxt-advanced-api',
    configKey: 'advancedApi',
    compatibility: {
      nuxt: '^3.0.0',
      bridge: false
    }
  },
  
  defaults: {
    enabled: true,
    apiKey: '',
    endpoint: '/api',
    enableLogging: false,
    cacheStrategy: 'memory',
    rateLimit: {
      enabled: false,
      requests: 100,
      window: 3600
    }
  },
  
  setup(options, nuxt) {
    const { resolve } = createResolver(import.meta.url)
    
    // 1. éªŒè¯é…ç½®
    if (!options.apiKey && nuxt.options.dev) {
      console.warn('API key is not provided for advanced-api module')
    }
    
    // 2. æ¡ä»¶æ€§æ¨¡å—åˆå§‹åŒ–
    if (!options.enabled) {
      console.info('Advanced API module is disabled')
      return
    }
    
    // 3. å®‰è£…ä¾èµ–æ¨¡å—
    installModule('@pinia/nuxt')
    
    // 4. æ³¨å†Œè¿è¡Œæ—¶æ’ä»¶
    addPlugin({
      src: resolve('./runtime/plugins/api-client.ts'),
      mode: 'all'
    })
    
    addPlugin({
      src: resolve('./runtime/plugins/error-handler.client.ts'),
      mode: 'client'
    })
    
    // 5. æ·»åŠ æœåŠ¡ç«¯å¤„ç†å™¨
    addServerHandler({
      route: `${options.endpoint}/**`,
      handler: resolve('./runtime/server/api-proxy.ts')
    })
    
    // 6. æ³¨å†Œç»„ä»¶
    addComponentsDir({
      path: resolve('./runtime/components'),
      prefix: 'Api',
      global: true
    })
    
    // 7. æ·»åŠ ç»„åˆå¼å‡½æ•°
    addImports([
      {
        name: 'useApiClient',
        as: 'useApiClient',
        from: resolve('./runtime/composables/useApiClient')
      },
      {
        name: 'useApiCache',
        as: 'useApiCache', 
        from: resolve('./runtime/composables/useApiCache')
      }
    ])
    
    // 8. ç”Ÿæˆé…ç½®æ–‡ä»¶æ¨¡æ¿
    addTemplate({
      filename: 'advanced-api.config.mjs',
      getContents: () => `
        export default ${JSON.stringify(options, null, 2)}
      `
    })
    
    // 9. æ³¨å…¥è¿è¡Œæ—¶é…ç½®
    nuxt.options.runtimeConfig.advancedApi = defu(
      nuxt.options.runtimeConfig.advancedApi as any,
      {
        apiKey: options.apiKey,
        endpoint: options.endpoint,
        enableLogging: options.enableLogging
      }
    )
    
    nuxt.options.runtimeConfig.public.advancedApi = defu(
      nuxt.options.runtimeConfig.public.advancedApi as any,
      {
        endpoint: options.endpoint,
        cacheStrategy: options.cacheStrategy
      }
    )
    
    // 10. æ³¨å†Œç”Ÿå‘½å‘¨æœŸé’©å­
    nuxt.hook('nitro:config', (nitroConfig) => {
      // é…ç½® Nitro å­˜å‚¨
      nitroConfig.storage = nitroConfig.storage || {}
      nitroConfig.storage.apiCache = {
        driver: options.cacheStrategy === 'redis' ? 'redis' : 'fs',
        base: './data/api-cache'
      }
    })
    
    nuxt.hook('build:done', () => {
      console.info('Advanced API module build completed')
    })
    
    // 11. å¼€å‘ç¯å¢ƒå¢å¼º
    if (nuxt.options.dev) {
      // æ·»åŠ å¼€å‘å·¥å…·
      addPlugin({
        src: resolve('./runtime/plugins/dev-tools.client.ts'),
        mode: 'client'
      })
    }
  }
})

// å¯¼å‡ºç±»å‹å®šä¹‰ä¾› TypeScript ä½¿ç”¨
declare module '@nuxt/schema' {
  interface NuxtConfig {
    advancedApi?: Partial<ModuleOptions>
  }
  interface NuxtOptions {
    advancedApi?: ModuleOptions
  }
}

declare module 'nuxt/schema' {
  interface NuxtConfig {
    advancedApi?: Partial<ModuleOptions>
  }
  interface NuxtOptions {
    advancedApi?: ModuleOptions
  }
}
```

#### è¿è¡Œæ—¶ä»£ç å®ç°

```typescript
// src/runtime/composables/useApiClient.ts
export const useApiClient = () => {
  const config = useRuntimeConfig()
  const { $apiCache } = useNuxtApp()
  
  const apiClient = $fetch.create({
    baseURL: config.public.advancedApi.endpoint,
    headers: {
      'Authorization': `Bearer ${config.advancedApi.apiKey}`
    },
    
    onRequest({ request, options }) {
      if (config.advancedApi.enableLogging) {
        console.log('API Request:', request, options)
      }
    },
    
    onResponse({ response }) {
      if (config.advancedApi.enableLogging) {
        console.log('API Response:', response.status, response._data)
      }
    },
    
    onResponseError({ response }) {
      console.error('API Error:', response.status, response._data)
      throw createError({
        statusCode: response.status,
        statusMessage: response._data?.message || 'API request failed'
      })
    }
  })
  
  const cachedFetch = async <T>(url: string, options: any = {}): Promise<T> => {
    const cacheKey = `api:${url}:${JSON.stringify(options)}`
    
    // å°è¯•ä»ç¼“å­˜è·å–
    const cached = await $apiCache.get<T>(cacheKey)
    if (cached) {
      return cached
    }
    
    // æ‰§è¡Œè¯·æ±‚
    const result = await apiClient<T>(url, options)
    
    // å­˜å‚¨åˆ°ç¼“å­˜
    await $apiCache.set(cacheKey, result, options.ttl || 300)
    
    return result
  }
  
  return {
    client: apiClient,
    cachedFetch,
    clearCache: () => $apiCache.clear()
  }
}
```

```typescript
// src/runtime/server/api-proxy.ts
export default defineEventHandler(async (event) => {
  const config = useRuntimeConfig()
  const method = getMethod(event)
  const path = getRouterParam(event, '_')
  
  // é€Ÿç‡é™åˆ¶æ£€æŸ¥
  if (config.advancedApi.rateLimit.enabled) {
    const clientIP = getClientIP(event)
    const isAllowed = await checkRateLimit(clientIP, config.advancedApi.rateLimit)
    
    if (!isAllowed) {
      throw createError({
        statusCode: 429,
        statusMessage: 'Too many requests'
      })
    }
  }
  
  try {
    // ä»£ç†è¯·æ±‚åˆ°å¤–éƒ¨ API
    const response = await $fetch(`${config.advancedApi.remoteEndpoint}/${path}`, {
      method,
      headers: {
        'Authorization': `Bearer ${config.advancedApi.apiKey}`,
        'Content-Type': 'application/json'
      },
      body: method !== 'GET' ? await readBody(event) : undefined
    })
    
    return response
  } catch (error) {
    throw createError({
      statusCode: error.statusCode || 500,
      statusMessage: error.message || 'Proxy request failed'
    })
  }
})

async function checkRateLimit(
  clientIP: string, 
  config: { requests: number; window: number }
): Promise<boolean> {
  const storage = useStorage('apiCache')
  const key = `ratelimit:${clientIP}`
  const now = Date.now()
  
  const requests = await storage.getItem<number[]>(key) || []
  const validRequests = requests.filter(time => now - time < config.window * 1000)
  
  if (validRequests.length >= config.requests) {
    return false
  }
  
  validRequests.push(now)
  await storage.setItem(key, validRequests, { ttl: config.window })
  
  return true
}
```

### 7.2.2 æ¨¡å—ç”Ÿå‘½å‘¨æœŸæ·±åº¦è§£æ

#### æ„å»ºæ—¶ç”Ÿå‘½å‘¨æœŸé’©å­

```typescript
// å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸé’©å­ç¤ºä¾‹
export default defineNuxtModule({
  setup(options, nuxt) {
    // 1. æ¨¡å—é…ç½®é˜¶æ®µ
    nuxt.hook('modules:before', () => {
      console.log('Before modules initialization')
    })
    
    nuxt.hook('modules:done', () => {
      console.log('All modules loaded')
    })
    
    // 2. é…ç½®è§£æé˜¶æ®µ
    nuxt.hook('ready', () => {
      console.log('Nuxt is ready, configuration is resolved')
    })
    
    // 3. æ„å»ºå‡†å¤‡é˜¶æ®µ
    nuxt.hook('build:before', () => {
      console.log('Before build starts')
      // åœ¨æ­¤é˜¶æ®µå¯ä»¥ä¿®æ”¹æ„å»ºé…ç½®
    })
    
    // 4. Nitro é…ç½®é˜¶æ®µ
    nuxt.hook('nitro:config', (nitroConfig) => {
      console.log('Configuring Nitro server')
      // é…ç½®æœåŠ¡ç«¯åŠŸèƒ½
      nitroConfig.plugins = nitroConfig.plugins || []
      nitroConfig.plugins.push(resolve('./runtime/server/nitro-plugin.ts'))
    })
    
    // 5. Vite/Webpack é…ç½®é˜¶æ®µ
    nuxt.hook('vite:extendConfig', (config) => {
      console.log('Extending Vite configuration')
      // æ‰©å±•æ„å»ºå·¥å…·é…ç½®
      config.plugins = config.plugins || []
      config.plugins.push(customVitePlugin())
    })
    
    // 6. æ„å»ºå®Œæˆé˜¶æ®µ
    nuxt.hook('build:done', () => {
      console.log('Build completed')
      // æ‰§è¡Œæ„å»ºåä»»åŠ¡
    })
    
    // 7. ç”Ÿæˆé˜¶æ®µ (ä»… SSG)
    nuxt.hook('generate:before', () => {
      console.log('Before static generation')
    })
    
    nuxt.hook('generate:done', () => {
      console.log('Static generation completed')
    })
    
    // 8. åº”ç”¨å…³é—­é˜¶æ®µ
    nuxt.hook('close', async () => {
      console.log('Cleaning up module resources')
      // æ¸…ç†èµ„æº
      await cleanupResources()
    })
  }
})
```

#### è¿è¡Œæ—¶ç”Ÿå‘½å‘¨æœŸç®¡ç†

```typescript
// src/runtime/plugins/lifecycle-manager.ts
export default defineNuxtPlugin({
  name: 'lifecycle-manager',
  parallel: false,
  setup(nuxtApp) {
    // åº”ç”¨åˆ›å»ºé˜¶æ®µ
    nuxtApp.hook('app:created', (vueApp) => {
      console.log('Vue app created')
      
      // æ³¨å†Œå…¨å±€å±æ€§
      vueApp.config.globalProperties.$moduleUtils = createModuleUtils()
      
      // è®¾ç½®é”™è¯¯å¤„ç†
      vueApp.config.errorHandler = (error, instance, info) => {
        console.error('Global error:', error, info)
        // å‘é€é”™è¯¯æŠ¥å‘Š
        sendErrorReport(error, instance, info)
      }
    })
    
    // åº”ç”¨æŒ‚è½½å‰
    nuxtApp.hook('app:beforeMount', () => {
      console.log('Before Vue app mount')
      // åˆå§‹åŒ–å…¨å±€çŠ¶æ€
      initializeGlobalState()
    })
    
    // åº”ç”¨æŒ‚è½½å
    nuxtApp.hook('app:mounted', () => {
      console.log('Vue app mounted')
      // å¯åŠ¨åå°ä»»åŠ¡
      startBackgroundTasks()
    })
    
    // é¡µé¢å¯¼èˆªé’©å­
    nuxtApp.hook('page:start', () => {
      console.log('Page navigation started')
      // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
      showLoadingIndicator()
    })
    
    nuxtApp.hook('page:finish', () => {
      console.log('Page navigation finished')
      // éšè—åŠ è½½æŒ‡ç¤ºå™¨
      hideLoadingIndicator()
    })
    
    // é”™è¯¯å¤„ç†é’©å­
    nuxtApp.hook('vue:error', (error, instance, info) => {
      console.error('Vue error:', error, info)
      // ä¼˜é›…çš„é”™è¯¯å¤„ç†
      handleVueError(error, instance, info)
    })
    
    return {
      provide: {
        moduleLifecycle: {
          onReady: (callback: Function) => {
            nuxtApp.hook('app:mounted', callback)
          },
          onError: (callback: Function) => {
            nuxtApp.hook('vue:error', callback)
          }
        }
      }
    }
  }
})
```

### 7.2.3 æ¨¡å—å‘å¸ƒä¸åˆ†äº«

#### NPM åŒ…å‘å¸ƒæµç¨‹

```json
{
  "name": "@yourorg/nuxt-advanced-api",
  "version": "1.0.0",
  "description": "Advanced API module for Nuxt 3",
  "keywords": ["nuxt", "api", "cache", "rate-limit"],
  "homepage": "https://github.com/yourorg/nuxt-advanced-api",
  "bugs": {
    "url": "https://github.com/yourorg/nuxt-advanced-api/issues"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/yourorg/nuxt-advanced-api.git"
  },
  "license": "MIT",
  "author": {
    "name": "Your Name",
    "email": "your.email@example.com"
  },
  "main": "./dist/module.mjs",
  "types": "./dist/types.d.ts",
  "exports": {
    ".": {
      "import": "./dist/module.mjs",
      "require": "./dist/module.cjs"
    }
  },
  "files": [
    "dist"
  ],
  "scripts": {
    "build": "nuxt-module-build",
    "dev": "nuxi dev playground",
    "dev:build": "nuxi build playground",
    "dev:prepare": "nuxt-module-build --stub && nuxi prepare playground",
    "docs:dev": "nuxi dev docs",
    "docs:build": "nuxi generate docs",
    "lint": "eslint .",
    "test": "vitest",
    "test:coverage": "vitest --coverage",
    "prepack": "nuxt-module-build"
  },
  "dependencies": {
    "@nuxt/kit": "^3.0.0",
    "defu": "^6.1.0"
  },
  "devDependencies": {
    "@nuxt/module-builder": "^0.5.0",
    "@nuxt/test-utils": "^3.0.0",
    "@types/node": "^18.0.0",
    "nuxt": "^3.0.0",
    "vitest": "^0.34.0"
  },
  "peerDependencies": {
    "nuxt": "^3.0.0"
  },
  "nuxt": {
    "compatibility": {
      "nuxt": "^3.0.0"
    }
  }
}
```

#### è‡ªåŠ¨åŒ–å‘å¸ƒå·¥ä½œæµ

```yaml
# .github/workflows/release.yml
name: Release
on:
  push:
    tags:
      - 'v*'

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run tests
        run: npm run test:coverage
      
      - name: Build module
        run: npm run build
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3

  release:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: 'npm'
          registry-url: 'https://registry.npmjs.org'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Build module
        run: npm run build
      
      - name: Generate changelog
        run: npx conventional-changelog-cli -p angular -i CHANGELOG.md -s
      
      - name: Publish to NPM
        run: npm publish
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
      
      - name: Create GitHub Release
        uses: actions/create-release@v1
        with:
          tag_name: ${{ github.ref_name }}
          release_name: Release ${{ github.ref_name }}
          body_path: CHANGELOG.md
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

#### æ¨¡å—æ–‡æ¡£ç”Ÿæˆ

```typescript
// docs/nuxt.config.ts - æ–‡æ¡£ç«™ç‚¹é…ç½®
export default defineNuxtConfig({
  extends: ['@nuxt/content-theme-docs'],
  
  content: {
    highlight: {
      theme: 'github-dark'
    }
  },
  
  app: {
    head: {
      title: 'Nuxt Advanced API Module',
      meta: [
        { name: 'description', content: 'Advanced API module documentation' }
      ]
    }
  }
})
```

```markdown
<!-- docs/content/1.introduction.md -->
# Introduction

The Nuxt Advanced API module provides a comprehensive solution for API management in Nuxt applications.

## Features

- ğŸš€ High-performance API proxy
- ğŸ’¾ Intelligent caching strategies
- ğŸ›¡ï¸ Built-in rate limiting
- ğŸ“Š Request/response logging
- ğŸ”’ Security enhancements
- ğŸ“ˆ Performance monitoring

## Quick Start

```bash
npm install @yourorg/nuxt-advanced-api
```

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  modules: ['@yourorg/nuxt-advanced-api'],
  
  advancedApi: {
    apiKey: process.env.API_KEY,
    endpoint: '/api',
    cacheStrategy: 'redis'
  }
})
```

## Usage

```vue
<script setup>
const { cachedFetch } = useApiClient()

const { data } = await cachedFetch('/users', {
  ttl: 300 // 5 minutes cache
})
</script>
```

```

## 7.3 æ’ä»¶ç³»ç»Ÿæ·±åº¦å¼€å‘

### 7.3.1 æ’ä»¶çš„åˆ›å»ºä¸æ³¨å†Œ

#### æ’ä»¶åŸºç¡€æ¶æ„

```typescript
// plugins/advanced-features.ts - é«˜çº§æ’ä»¶å¼€å‘æ¨¡å¼
export default defineNuxtPlugin({
  name: 'advanced-features',
  
  // æ’ä»¶ä¾èµ–å…³ç³»
  dependsOn: ['pinia', 'vue-router'],
  
  // å¹¶è¡Œæ‰§è¡Œæ§åˆ¶
  parallel: true,
  
  // ç¯å¢ƒæ§åˆ¶
  mode: 'all', // 'client' | 'server' | 'all'
  
  async setup(nuxtApp) {
    // 1. åˆå§‹åŒ–æ ¸å¿ƒæœåŠ¡
    const logger = createLogger('advanced-features')
    const eventBus = createEventBus()
    const storage = createStorage()
    
    // 2. æ³¨å†Œå…¨å±€å±æ€§
    nuxtApp.provide('logger', logger)
    nuxtApp.provide('eventBus', eventBus)
    nuxtApp.provide('storage', storage)
    
    // 3. è®¾ç½®å…¨å±€é”™è¯¯å¤„ç†
    nuxtApp.hook('vue:error', (error, instance, info) => {
      logger.error('Vue Error:', { error, instance, info })
      
      // å‘é€é”™è¯¯æŠ¥å‘Š
      if (process.client) {
        sendErrorToService(error, instance, info)
      }
    })
    
    // 4. è·¯ç”±æ‹¦æˆªå™¨
    if (process.client) {
      const router = useRouter()
      
      router.beforeEach(async (to, from) => {
        logger.info(`Navigation: ${from.path} -> ${to.path}`)
        
        // æƒé™æ£€æŸ¥
        if (to.meta.requiresAuth && !isAuthenticated()) {
          throw createError({
            statusCode: 401,
            statusMessage: 'Authentication required'
          })
        }
        
        // é¡µé¢åˆ†æ
        trackPageView(to.path)
      })
    }
    
    return {
      provide: {
        // å¯¼å‡ºå¯åœ¨åº”ç”¨ä¸­ä½¿ç”¨çš„æ–¹æ³•
        utils: {
          formatDate: (date: Date) => date.toISOString(),
          generateId: () => Math.random().toString(36).substring(7)
        }
      }
    }
  }
})
```

### 7.3.2 å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ’ä»¶

#### æœåŠ¡ç«¯ä¸“ç”¨æ’ä»¶

```typescript
// plugins/server-enhancement.server.ts
export default defineNuxtPlugin({
  name: 'server-enhancement',
  
  async setup(nuxtApp) {
    const config = useRuntimeConfig()
    
    // 1. æœåŠ¡ç«¯æ—¥å¿—ç³»ç»Ÿ
    const serverLogger = {
      request: (req: any) => {
        console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`)
      },
      
      error: (error: Error, context: any) => {
        console.error(`[ERROR] ${error.message}`, {
          stack: error.stack,
          context,
          timestamp: new Date().toISOString()
        })
      },
      
      performance: (operation: string, duration: number) => {
        console.log(`[PERF] ${operation}: ${duration}ms`)
      }
    }
    
    // 2. å“åº”å¢å¼º
    nuxtApp.hook('render:html', (html, { event }) => {
      const duration = Date.now() - event.context.requestStart
      serverLogger.performance('SSR Render', duration)
      
      // æ·»åŠ æ€§èƒ½å¤´
      setHeader(event, 'X-Render-Time', `${duration}ms`)
      setHeader(event, 'X-Server-Instance', process.env.INSTANCE_ID || 'unknown')
    })
    
    return {
      provide: {
        serverLogger
      }
    }
  }
})
```

#### å®¢æˆ·ç«¯ä¸“ç”¨æ’ä»¶

```typescript
// plugins/client-enhancement.client.ts
export default defineNuxtPlugin({
  name: 'client-enhancement',
  
  async setup(nuxtApp) {
    // 1. å®¢æˆ·ç«¯å­˜å‚¨ç®¡ç†
    const clientStorage = {
      set: (key: string, value: any, expiry?: number) => {
        const item = {
          value,
          expiry: expiry ? Date.now() + expiry : null
        }
        localStorage.setItem(key, JSON.stringify(item))
      },
      
      get: (key: string) => {
        const item = localStorage.getItem(key)
        if (!item) return null
        
        try {
          const parsed = JSON.parse(item)
          if (parsed.expiry && Date.now() > parsed.expiry) {
            localStorage.removeItem(key)
            return null
          }
          return parsed.value
        } catch {
          return null
        }
      },
      
      remove: (key: string) => localStorage.removeItem(key),
      clear: () => localStorage.clear()
    }
    
    // 2. è®¾å¤‡ä¿¡æ¯æ£€æµ‹
    const deviceInfo = reactive({
      userAgent: navigator.userAgent,
      platform: navigator.platform,
      language: navigator.language,
      cookieEnabled: navigator.cookieEnabled,
      onLine: navigator.onLine,
      screenWidth: window.screen.width,
      screenHeight: window.screen.height,
      viewportWidth: window.innerWidth,
      viewportHeight: window.innerHeight,
      isMobile: /Mobi|Android/i.test(navigator.userAgent),
      isTablet: /iPad|Tablet/i.test(navigator.userAgent),
      isDesktop: !/Mobi|Android|iPad|Tablet/i.test(navigator.userAgent)
    })
    
    return {
      provide: {
        clientStorage,
        deviceInfo: readonly(deviceInfo)
      }
    }
  }
})
```

### 7.3.3 æ’ä»¶çš„æ‰§è¡Œé¡ºåº

#### æ’ä»¶ä¾èµ–ç®¡ç†

```typescript
// plugins/01.foundation.ts
export default defineNuxtPlugin({
  name: 'foundation',
  parallel: false, // ä¸²è¡Œæ‰§è¡Œï¼Œç¡®ä¿åŸºç¡€æœåŠ¡å…ˆåˆå§‹åŒ–
  
  setup(nuxtApp) {
    // åŸºç¡€æœåŠ¡åˆå§‹åŒ–
    const logger = createLogger()
    const eventBus = createEventBus()
    const httpClient = createHttpClient()
    
    nuxtApp.provide('logger', logger)
    nuxtApp.provide('eventBus', eventBus)
    nuxtApp.provide('httpClient', httpClient)
    
    return {
      provide: {
        foundation: {
          logger,
          eventBus,
          httpClient
        }
      }
    }
  }
})

// plugins/02.authentication.ts
export default defineNuxtPlugin({
  name: 'authentication',
  dependsOn: ['foundation'], // ä¾èµ–åŸºç¡€æ’ä»¶
  parallel: false,
  
  async setup(nuxtApp) {
    const { $logger, $httpClient } = nuxtApp
    
    const authService = {
      currentUser: ref(null),
      
      async login(credentials: any) {
        try {
          const response = await $httpClient.post('/api/auth/login', credentials)
          this.currentUser.value = response.user
          return response
        } catch (error) {
          $logger.error('Login failed:', error)
          throw error
        }
      },
      
      async logout() {
        await $httpClient.post('/api/auth/logout')
        this.currentUser.value = null
      }
    }
    
    return {
      provide: {
        auth: authService
      }
    }
  }
})
```

## æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹

### æ¨¡å—å¼€å‘æœ€ä½³å®è·µ

#### 1. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ `lazy` åŠ è½½éå…³é”®åŠŸèƒ½
- å®æ–½æ™ºèƒ½ç¼“å­˜ç­–ç•¥
- é¿å…é˜»å¡ä¸»çº¿ç¨‹çš„æ“ä½œ
- ä¼˜åŒ–åŒ…å¤§å°å’Œä¾èµ–å…³ç³»

#### 2. é”™è¯¯å¤„ç†
- å®æ–½å…¨é¢çš„é”™è¯¯è¾¹ç•Œ
- æä¾›ä¼˜é›…çš„é™çº§æ–¹æ¡ˆ
- è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- æ”¯æŒé”™è¯¯æ¢å¤æœºåˆ¶

#### 3. å¯ç»´æŠ¤æ€§
- éµå¾ªå•ä¸€èŒè´£åŸåˆ™
- æä¾›å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- ç¼–å†™å…¨é¢çš„å•å…ƒæµ‹è¯•
- ç»´æŠ¤æ¸…æ™°çš„æ–‡æ¡£

### å¼€å‘æ³¨æ„äº‹é¡¹

::alert{icon="lucide:alert-triangle" color="amber"}
**é‡è¦æé†’**:
1. æ¨¡å—å¼€å‘éœ€è¦æ·±å…¥ç†è§£ Nuxt ç”Ÿå‘½å‘¨æœŸå’Œæ„å»ºè¿‡ç¨‹
2. æ’ä»¶æ‰§è¡Œé¡ºåºå¯¹åº”ç”¨åŠŸèƒ½æ­£ç¡®æ€§è‡³å…³é‡è¦
3. æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä»£ç éœ€è¦ä¸¥æ ¼åŒºåˆ†ï¼Œé¿å…ç¯å¢ƒç›¸å…³é”™è¯¯
4. æ¨¡å—å‘å¸ƒå‰å¿…é¡»è¿›è¡Œå……åˆ†çš„æµ‹è¯•å’Œå…¼å®¹æ€§éªŒè¯
::

### æ¨èçš„å¼€å‘å·¥å…·

- **@nuxt/kit**: å®˜æ–¹æ¨¡å—å¼€å‘å·¥å…·åŒ…
- **@nuxt/module-builder**: æ¨¡å—æ„å»ºå’Œæ‰“åŒ…å·¥å…·
- **@nuxt/test-utils**: æµ‹è¯•å·¥å…·é›†
- **vitest**: å¿«é€Ÿçš„å•å…ƒæµ‹è¯•æ¡†æ¶
- **typescript**: ç±»å‹å®‰å…¨å¼€å‘

é€šè¿‡æ·±å…¥å­¦ä¹ æœ¬æŒ‡å—çš„å†…å®¹ï¼Œæ‚¨å°†èƒ½å¤Ÿæ„å»ºé«˜è´¨é‡ã€å¯å¤ç”¨çš„ Nuxt æ¨¡å—å’Œæ’ä»¶ï¼Œä¸º Nuxt ç”Ÿæ€ç³»ç»Ÿè´¡çŒ®ä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆã€‚è®°ä½ï¼Œä¼˜ç§€çš„æ¨¡å—ä¸ä»…è¦åŠŸèƒ½å¼ºå¤§ï¼Œè¿˜è¦æ˜“äºä½¿ç”¨ã€æ–‡æ¡£å®Œå–„ã€æµ‹è¯•è¦†ç›–ç‡é«˜ã€‚ 